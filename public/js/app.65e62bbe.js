(function(a){function t(t){for(var s,r,l=t[0],n=t[1],c=t[2],_=0,p=[];_<l.length;_++)r=l[_],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&p.push(i[r][0]),i[r]=0;for(s in n)Object.prototype.hasOwnProperty.call(n,s)&&(a[s]=n[s]);d&&d(t);while(p.length)p.shift()();return o.push.apply(o,c||[]),e()}function e(){for(var a,t=0;t<o.length;t++){for(var e=o[t],s=!0,l=1;l<e.length;l++){var n=e[l];0!==i[n]&&(s=!1)}s&&(o.splice(t--,1),a=r(r.s=e[0]))}return a}var s={},i={app:0},o=[];function r(t){if(s[t])return s[t].exports;var e=s[t]={i:t,l:!1,exports:{}};return a[t].call(e.exports,e,e.exports,r),e.l=!0,e.exports}r.m=a,r.c=s,r.d=function(a,t,e){r.o(a,t)||Object.defineProperty(a,t,{enumerable:!0,get:e})},r.r=function(a){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},r.t=function(a,t){if(1&t&&(a=r(a)),8&t)return a;if(4&t&&"object"===typeof a&&a&&a.__esModule)return a;var e=Object.create(null);if(r.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:a}),2&t&&"string"!=typeof a)for(var s in a)r.d(e,s,function(t){return a[t]}.bind(null,s));return e},r.n=function(a){var t=a&&a.__esModule?function(){return a["default"]}:function(){return a};return r.d(t,"a",t),t},r.o=function(a,t){return Object.prototype.hasOwnProperty.call(a,t)},r.p="public/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],n=l.push.bind(l);l.push=t,l=l.slice();for(var c=0;c<l.length;c++)t(l[c]);var d=n;o.push([0,"chunk-vendors"]),e()})({0:function(a,t,e){a.exports=e("56d7")},"0048":function(a,t,e){},"02c6":function(a,t,e){"use strict";e("1627")},"0958":function(a,t,e){},1627:function(a,t,e){},"1b23":function(a,t,e){"use strict";e("e072")},"2a51":function(a,t,e){},"2f12":function(a,t,e){"use strict";e("853c")},"364e":function(a,t,e){"use strict";e("9ba8")},"3c2c":function(a,t,e){"use strict";e.r(t);var s=function(){var a=this,t=a._self._c;return t("div",{staticClass:"container-fluid p-0"},[t("loader-component",{attrs:{cargando_pagina:a.cargando_pagina}}),t("b-card",{staticClass:"mt-4"},[t("div",{staticClass:"row"},[t("div",{staticClass:"col"},[t("h5",{staticClass:"mb-3"},[a._v("Valorizaciones registradas")])]),t("div",{staticClass:"col"},[t("b-form-input",{staticClass:"mb-3",attrs:{size:"sm",placeholder:"Buscar valorización"},model:{value:a.busqueda,callback:function(t){a.busqueda=t},expression:"busqueda"}})],1)]),t("div",{staticClass:"row justify-content-center"},[t("b-table",{staticClass:"rounded",attrs:{striped:"",hover:"",items:a.valorizaciones,fields:a.columnas_valorizaciones,filter:a.busqueda,"thead-tr-class":"text-center align-middle bg-dark text-white"},scopedSlots:a._u([{key:"cell(val_fecha_hora)",fn:function(t){return[a._v(" "+a._s(t.value.split(" ")[0].split("-")[2]+"/"+t.value.split(" ")[0].split("-")[1]+"/"+t.value.split(" ")[0].split("-")[0]+" "+t.value.split(" ")[1].split(":")[0]+":"+t.value.split(" ")[1].split(":")[1])+" ")]}},{key:"cell(val_finalizada)",fn:function(e){return[t("div",{staticClass:"w-100 text-center"},[1==e.value?t("b-badge",{attrs:{variant:"success"}},[a._v("Finalizada")]):t("b-badge",{attrs:{variant:"danger"}},[a._v("Pendiente")])],1)]}},{key:"cell(opcion)",fn:function(e){return[t("div",{staticClass:"w-100 text-center"},[t("b-button",{attrs:{size:"sm",variant:"primary"},on:{click:function(t){return a.verValorizacion(e.item.val_id)}}},[t("i",{staticClass:"fas fa-eye"})])],1)]}}])})],1)])],1)},i=[],o={data(){return{cargando_pagina:!1,valorizaciones:[],busqueda:"",columnas_valorizaciones:[{key:"val_id",label:"ID",sortable:!1,tdClass:"p-1 text-center",thClass:"p-1"},{key:"val_oc",label:"OC",sortable:!1,tdClass:"p-1 text-center",thClass:"p-1"},{key:"val_factura",label:"Factura",sortable:!1,tdClass:"p-1 text-center",thClass:"p-1"},{key:"val_din",label:"DIN",sortable:!1,tdClass:"p-1 text-center",thClass:"p-1"},{key:"val_rut_carpeta",label:"Rut carpeta",sortable:!1,tdClass:"p-1 text-center",thClass:"p-1"},{key:"val_fecha_hora",label:"Fecha",sortable:!1,tdClass:"p-1 text-center",thClass:"p-1"},{key:"val_finalizada",label:"Estado",sortable:!1,tdClass:"p-1 text-center",thClass:"p-1"},{key:"opcion",label:"-",sortable:!1,tdClass:"p-1 text-center",thClass:"p-1"}]}},mounted(){this.listarValorizaciones()},methods:{listarValorizaciones(){this.cargando_pagina=!0,axios.get(base_url+"valorizacion/listarValorizaciones").then(a=>{1==a.data.key?this.valorizaciones=a.data.valorizaciones:alert("Falla al listar valorizaciones."),this.cargando_pagina=!1}).catch(a=>{alert("Error: "+a),this.cargando_pagina=!1})},verValorizacion(a){this.$emit("ver_val",a)}}},r=o,l=(e("02c6"),e("2877")),n=Object(l["a"])(r,s,i,!1,null,null,null);t["default"]=n.exports},"3e74":function(a,t,e){"use strict";e.r(t);var s=function(){var a=this,t=a._self._c;return t("div",{staticClass:"container-fluid p-0"},[t("loader-component",{attrs:{cargando_pagina:a.cargando_pagina}}),t("biometria-component",{attrs:{modal_verificar_huella:a.modal_verificar_huella,funcion_ejecucion:a.funcion_verificar},on:{verificacion_correcta:a.verificacionCorrecta,cerrar_modal_biometria:function(t){a.modal_verificar_huella=!1}}}),a.cargando_pagina?a._e():t("div",{staticClass:"row justify-content-center mt-4"},[t("div",{staticClass:"col-12"},[t("b-card",[t("div",{staticClass:"container-fluid p-0 mb-3"},[t("div",{staticClass:"row justify-content-end mb-3"},[t("div",{staticClass:"col text-left"},[t("h4",[a._v("Valorización "+a._s(a.val_id_p))]),a.valorizacion.val_fecha_hora?t("h6",[a._v("Fecha: "+a._s(a.valorizacion.val_fecha_hora.split(" ")[0].split("-").reverse().join("-")+" "+a.valorizacion.val_fecha_hora.split(" ")[1].split(":").slice(0,2).join(":"))+" ")]):a._e()]),t("div",{staticClass:"col-xl-2 col-md-3 col-6"},[t("b-button",{attrs:{variant:"danger",size:"sm",block:""},on:{click:function(t){a.modal_confirmar_cancelar=!0}}},[t("i",{staticClass:"fas fa-times mr-2"}),a._v("CERRAR")])],1),a.valorizacion.val_finalizada?a._e():t("div",{staticClass:"col-xl-2 col-md-3 col-6"},[t("b-button",{attrs:{variant:"primary",size:"sm",block:""},on:{click:function(t){a.funcion_verificar="guardarValorizacion",a.modal_verificar_huella=!0}}},[t("i",{staticClass:"fas fa-save mr-2"}),a._v("GUARDAR")])],1),a.valorizacion.val_finalizada?a._e():t("div",{staticClass:"col-xl-2 col-md-3 col-6"},[t("b-button",{attrs:{variant:"success",size:"sm",block:""},on:{click:function(t){a.modal_confirmar_finalizar=!0}}},[t("i",{staticClass:"fas fa-chevron-circle-right mr-2"}),a._v("FINALIZAR")])],1)]),t("div",{staticClass:"row justify-content-center"},[t("div",{staticClass:"col-xl-4 col-md-6 col-12 mb-2"},[t("b-input-group",{attrs:{prepend:"Factura",size:"sm"}},[t("b-form-input",{attrs:{disabled:a.valorizacion.val_finalizada,placeholder:"Ej. 14322"},model:{value:a.valorizacion.val_factura,callback:function(t){a.$set(a.valorizacion,"val_factura",t)},expression:"valorizacion.val_factura"}})],1)],1),t("div",{staticClass:"col-xl-4 col-md-6 col-12 mb-2"},[t("b-input-group",{attrs:{prepend:"DIN",size:"sm"}},[t("b-form-input",{attrs:{disabled:a.valorizacion.val_finalizada,placeholder:"Ej. 14322"},model:{value:a.valorizacion.val_din,callback:function(t){a.$set(a.valorizacion,"val_din",t)},expression:"valorizacion.val_din"}})],1)],1),t("div",{staticClass:"col-xl-4 col-md-6 col-12 mb-2"},[t("b-input-group",{attrs:{prepend:"Rut Carpeta",size:"sm"}},[t("b-form-input",{attrs:{disabled:a.valorizacion.val_finalizada,placeholder:"Ej. 14322"},model:{value:a.valorizacion.val_rut_carpeta,callback:function(t){a.$set(a.valorizacion,"val_rut_carpeta",t)},expression:"valorizacion.val_rut_carpeta"}})],1)],1),t("div",{staticClass:"col-xl-4 col-md-6 col-12 mb-2"},[t("b-input-group",{attrs:{prepend:"Costo Importacion (moneda extranjera)",size:"sm"}},[t("b-form-input",{attrs:{disabled:a.valorizacion.val_finalizada,placeholder:"Ej. 14322"},on:{input:function(t){a.valorizacion.val_costo_importacion=a.formatearMiles(a.valorizacion.val_costo_importacion),a.reajustaValoresOC()},change:function(t){return a.tipoCambio()}},model:{value:a.valorizacion.val_costo_importacion,callback:function(t){a.$set(a.valorizacion,"val_costo_importacion",t)},expression:"valorizacion.val_costo_importacion"}})],1)],1),t("div",{staticClass:"col-xl-4 col-md-6 col-12 mb-2"},[t("b-input-group",{attrs:{prepend:"CIF Pagado (pesos)",size:"sm"}},[t("b-form-input",{attrs:{disabled:a.valorizacion.val_finalizada,placeholder:"Ej. 14322"},on:{input:function(t){a.valorizacion.val_costo_pagado=a.formatearMiles(a.valorizacion.val_costo_pagado)},change:function(t){return a.tipoCambio()}},model:{value:a.valorizacion.val_costo_pagado,callback:function(t){a.$set(a.valorizacion,"val_costo_pagado",t)},expression:"valorizacion.val_costo_pagado"}})],1)],1),t("div",{staticClass:"col-xl-4 col-md-6 col-12 mb-2"},[t("b-input-group",{attrs:{prepend:"Comisión Banco $ ",size:"sm"}},[t("b-form-input",{attrs:{disabled:a.valorizacion.val_finalizada,placeholder:"Ej. 14322"},on:{input:function(t){a.valorizacion.val_comision_banco=a.formatearMiles(a.valorizacion.val_comision_banco),a.reajustaValoresOC()}},model:{value:a.valorizacion.val_comision_banco,callback:function(t){a.$set(a.valorizacion,"val_comision_banco",t)},expression:"valorizacion.val_comision_banco"}})],1)],1)])]),t("b-table",{staticClass:"rounded",attrs:{striped:"",hover:"",items:a.valorizacion.items,fields:a.columnas_valorizacion,"thead-tr-class":"text-center align-middle bg-dark text-white"},scopedSlots:a._u([{key:"cell(vco_id_glosa)",fn:function(e){return[t("b-form-select",{attrs:{disabled:a.valorizacion.val_finalizada,options:a.glosas_valorizacion,size:"sm","value-field":"glo_id","text-field":"glo_glosa"},model:{value:e.item.vco_id_glosa,callback:function(t){a.$set(e.item,"vco_id_glosa",t)},expression:"data.item.vco_id_glosa"}})]}},{key:"cell(vco_monto)",fn:function(e){return[t("b-form-input",{attrs:{disabled:a.valorizacion.val_finalizada,size:"sm"},on:{input:function(t){e.item.vco_monto=a.formatearMiles(e.item.vco_monto),a.reajustaValoresOC()}},model:{value:e.item.vco_monto,callback:function(t){a.$set(e.item,"vco_monto",t)},expression:"data.item.vco_monto"}})]}},{key:"cell(vco_observacion)",fn:function(e){return[t("b-form-input",{attrs:{disabled:a.valorizacion.val_finalizada,size:"sm"},on:{keyup:function(t){return!t.type.indexOf("key")&&a._k(t.keyCode,"enter",13,t.key,"Enter")?null:a.actualizarObservacion(e.item.id)}},model:{value:e.item.vco_observacion,callback:function(t){a.$set(e.item,"vco_observacion",t)},expression:"data.item.vco_observacion"}})]}},{key:"cell(opcion)",fn:function(e){return[t("div",{staticClass:"w-100 text-center"},[e.index>0&&!a.valorizacion.val_finalizada?t("b-button",{attrs:{size:"sm",variant:"danger"},on:{click:function(t){return a.eliminarItem(e.index)}}},[t("i",{staticClass:"fas fa-trash-alt"})]):a._e()],1)]}},{key:"head(opcion)",fn:function(e){return[t("div",{staticClass:"w-100 text-center"},[a.valorizacion.val_finalizada?a._e():t("b-button",{attrs:{variant:"primary",size:"sm",block:""},on:{click:function(t){return a.agregarItem()}}},[t("i",{staticClass:"fas fa-plus fa-fw"})])],1)]}}],null,!1,3360289321)}),t("div",{staticClass:"row justify-content-center"},[t("div",{staticClass:"col-xl-3 col-md-4 col-6"},[t("b-button",{attrs:{variant:"outline-success",size:"sm",block:""},on:{click:function(t){a.modal_nueva_glosa=!0}}},[t("i",{staticClass:"fas fa-plus mr-2"}),a._v("CREAR NUEVA GLOSA")])],1)]),t("div",{staticClass:"row mt-2"},[t("div",{staticClass:"col-12 text-right"},[t("table",{staticClass:"ml-auto"},[t("tr",[t("td",[a._v("Total gastos de importación : ")]),t("td",[t("b",{domProps:{textContent:a._s("$ "+a.totalCostos().toLocaleString("de-DE"))}})])]),t("tr",[t("td",[a._v("Tipo de cambio inicial : ")]),t("td",[t("b",{domProps:{textContent:a._s("$ "+parseFloat(parseFloat(a.tipoCambio().toFixed(2))).toLocaleString("de-DE"))}})])]),t("tr",[t("td",[a._v("% Gasto S/Import. : ")]),t("td",[t("b",{domProps:{textContent:a._s("% "+100*parseFloat(parseFloat(a.porcentajeCostos()).toFixed(2)))}})])]),t("tr",[t("td",[a._v("Tipo de cambio reajustado : ")]),t("td",[t("b",{domProps:{textContent:a._s("$ "+parseFloat(parseFloat(a.tipoCambioReajustado()).toFixed(2)).toLocaleString("de-DE"))}})])])])])])],1)],1),t("div",{staticClass:"col-12"},[t("b-card",{staticClass:"mt-4"},[t("div",{staticClass:"container-fluid p-0 mb-3"},[t("div",{staticClass:"row justify-content-end mb-3"},[t("div",{staticClass:"col text-left"},[t("h4",[a._v("Orden de compra "+a._s(a.orden_compra.voc_oc))])])])]),t("table",{staticClass:"w-100"},[t("td",[t("tr",[t("strong",{staticClass:"pr-3"},[a._v("Fecha")]),a._v(":"),t("span",{staticClass:"pl-3"},[a._v(a._s(a.orden_compra.voc_fecha))])])]),t("td",[t("tr",[t("strong",{staticClass:"pr-3"},[a._v("Bodega")]),a._v(":"),t("span",{staticClass:"pl-3"},[a._v(a._s(a.orden_compra.voc_bodega))])])]),t("td",[t("tr",[t("strong",{staticClass:"pr-3"},[a._v("Glosa")]),a._v(":"),t("span",{staticClass:"pl-3"},[a._v(a._s(a.orden_compra.voc_glosa))])])])]),""!=a.orden_compra.mensaje?t("h6",[t("strong",[a._v("Mensaje:")]),a._v(" "+a._s(a.orden_compra.voc_mensaje))]):a._e(),t("b-table",{staticClass:"mt-2",attrs:{striped:"",hover:"",items:a.orden_compra.articulos,fields:a.columnas_articulos,"thead-tr-class":"text-center align-middle bg-dark text-white"},scopedSlots:a._u([{key:"cell(vao_codigo)",fn:function(t){return[a._v(" "+a._s(t.item.vao_codigo+"-"+t.item.vao_ver)+" ")]}},{key:"cell(vao_cantidad)",fn:function(t){return[a._v(" "+a._s(t.value.toLocaleString("de-DE"))+" ")]}},{key:"cell(vao_valor_m_extranjera)",fn:function(e){return[t("b-form-input",{attrs:{disabled:a.valorizacion.val_finalizada,size:"sm"},on:{input:function(t){e.item.vao_valor_m_extranjera=a.formatearMiles(e.item.vao_valor_m_extranjera),a.reajustaValoresOC()}},model:{value:e.item.vao_valor_m_extranjera,callback:function(t){a.$set(e.item,"vao_valor_m_extranjera",t)},expression:"data.item.vao_valor_m_extranjera"}})]}},{key:"cell(vao_total_extra)",fn:function(t){return[a._v(" "+a._s(t.value.toLocaleString("de-DE"))+" ")]}},{key:"cell(vao_total_pesos)",fn:function(t){return[a._v(" "+a._s(parseInt(t.value).toLocaleString("de-DE"))+" ")]}},{key:"cell(vao_valor_pesos)",fn:function(t){return[a._v(" "+a._s(parseInt(t.value).toLocaleString("de-DE"))+" ")]}}],null,!1,4194834588)})],1)],1)]),t("b-modal",{attrs:{size:"md",title:"NUEVA GLOSA","hide-footer":"","no-close-on-backdrop":"",scrollable:!1},model:{value:a.modal_nueva_glosa,callback:function(t){a.modal_nueva_glosa=t},expression:"modal_nueva_glosa"}},[t("div",{staticClass:"row"},[t("div",{staticClass:"col-12"},[t("h6",[a._v("Nueva glosa:")]),t("b-form-input",{attrs:{placeholder:"Ej. Gastos extra."},model:{value:a.nueva_glosa,callback:function(t){a.nueva_glosa=t},expression:"nueva_glosa"}})],1)]),t("div",{staticClass:"row mt-3 pt-3 border-top justify-content-center"},[t("div",{staticClass:"col-4 text-center"},[t("b-button",{attrs:{variant:"danger",size:"sm"},on:{click:function(t){a.modal_nueva_glosa=!1,a.nueva_glosa=""}}},[t("i",{staticClass:"fas fa-ban fa-fw ml-2"}),a._v("CANCELAR")])],1),t("div",{staticClass:"col-4 text-center"},[t("b-button",{attrs:{variant:"success",size:"sm"},on:{click:function(t){return a.registrarGlosa()}}},[t("i",{staticClass:"fas fa-save fa-fw ml-2"}),a._v("REGISTRAR")])],1)])]),t("b-modal",{attrs:{size:"md",title:"CANCELAR","hide-footer":"","no-close-on-backdrop":"",scrollable:!1},model:{value:a.modal_confirmar_cancelar,callback:function(t){a.modal_confirmar_cancelar=t},expression:"modal_confirmar_cancelar"}},[t("div",{staticClass:"row"},[t("div",{staticClass:"col-12 text-center"},[t("h5",[a._v("¿Confirma que desea salir de la valorización?")])])]),t("div",{staticClass:"row mt-3 pt-3 border-top justify-content-center"},[t("div",{staticClass:"col-4 text-center"},[t("b-button",{attrs:{variant:"danger",size:"sm"},on:{click:function(t){a.modal_confirmar_cancelar=!1,a.nueva_glosa=""}}},[t("i",{staticClass:"fas fa-ban fa-fw mr-2"}),a._v("CANCELAR")])],1),t("div",{staticClass:"col-4 text-center"},[t("b-button",{attrs:{variant:"success",size:"sm"},on:{click:function(t){return a.cerrarValoricacion()}}},[t("i",{staticClass:"fas fa-check-circle fa-fw mr-2"}),a._v("CONFIRMAR")])],1)])]),t("b-modal",{attrs:{size:"md",title:"FINALIZAR","hide-footer":"","no-close-on-backdrop":"",scrollable:!1},model:{value:a.modal_confirmar_finalizar,callback:function(t){a.modal_confirmar_finalizar=t},expression:"modal_confirmar_finalizar"}},[t("div",{staticClass:"row"},[t("div",{staticClass:"col-12 text-center"},[t("h5",[a._v("¿Confirma que desea finalizar la valorización?")]),t("h6",{staticClass:"text-danger"},[a._v("Una vez finalizada no podrá editar la valorización.")])])]),t("div",{staticClass:"row mt-3 pt-3 border-top justify-content-center"},[t("div",{staticClass:"col-4 text-center"},[t("b-button",{attrs:{variant:"danger",size:"sm"},on:{click:function(t){a.modal_confirmar_finalizar=!1,a.nueva_glosa=""}}},[t("i",{staticClass:"fas fa-ban fa-fw mr-2"}),a._v("CANCELAR")])],1),t("div",{staticClass:"col-4 text-center"},[t("b-button",{attrs:{variant:"success",size:"sm"},on:{click:function(t){a.funcion_verificar="finalizarValorizacion",a.modal_verificar_huella=!0,a.modal_confirmar_finalizar=!1}}},[t("i",{staticClass:"fas fa-check-circle fa-fw mr-2"}),a._v("FINALIZAR")])],1)])]),t("b-modal",{attrs:{size:"lg",title:"REGISTRO VALORIZACIÓN","hide-footer":"","no-close-on-backdrop":"",scrollable:!1},model:{value:a.modal_msj,callback:function(t){a.modal_msj=t},expression:"modal_msj"}},[t("div",{staticClass:"row"},[t("div",{staticClass:"col-12"},[t("h6",{staticClass:"text-center"},[t("strong",[a._v(a._s(a.msj_registro))])])])]),t("div",{staticClass:"row mt-3 pt-3 border-top"},[t("div",{staticClass:"col text-center"},[t("b-button",{attrs:{variant:"primary",size:"sm"},on:{click:function(t){return a.cerrarValoricacion()}}},[a._v("ACEPTAR")])],1)])])],1)},i=[],o={props:["val_id_p"],data(){return{cargando_pagina:!1,modal_verificar_huella:!1,funcion_verificar:"",modal_msj:!1,msj_registro:"",fecha_actual:"",columnas_valorizacion:[{key:"vco_id_glosa",label:"Glosa",sortable:!1,tdClass:"p-1",thClass:"p-1"},{key:"vco_observacion",label:"Observacion",sortable:!1,tdClass:"p-1",thClass:"p-1"},{key:"vco_monto",label:"Monto",sortable:!1,tdClass:"p-1",thClass:"p-1"},{key:"opcion",label:"-",sortable:!1,tdClass:"p-1",thClass:"p-1"}],valorizacion:{val_id:"",val_fecha_hora:"",val_factura:"",val_din:"",val_rut_carpeta:"",val_costo_importacion:"",val_costo_pagado:"",val_comision_banco:"",val_porcentaje_costos:0,val_tipo_cambio:"",val_tipo_cambio_reajustado:"",val_total_gastos:"",items:[{vco_id:0,vco_glosa:"",vco_observacion:"",vco_monto:""}]},modal_confirmar_cancelar:!1,modal_confirmar_finalizar:!1,modal_nueva_glosa:!1,nueva_glosa:"",glosas_valorizacion:[],muestra_calculos:!1,columnas_articulos:[{key:"vao_codigo",label:"Codigo",sortable:!1,tdClass:"p-1",thClass:"p-1"},{key:"vao_nombre",label:"Articulo",sortable:!1,tdClass:"p-1",thClass:"p-1"},{key:"vao_unidad_medida",label:"U. Medida",sortable:!1,tdClass:"p-1 text-center",thClass:"p-1"},{key:"vao_cantidad",label:"Cantidad",sortable:!1,tdClass:"p-1 text-center",thClass:"p-1"},{key:"vao_valor_m_extranjera",label:"Valor Unitario M. Extranjera",sortable:!1,tdClass:"p-1 text-center",thClass:"p-1"},{key:"vao_total_extra",label:"Total M. Extranjera",sortable:!1,tdClass:"p-1 text-center",thClass:"p-1"},{key:"vao_total_pesos",label:"Total Pesos",sortable:!1,tdClass:"p-1 text-center",thClass:"p-1"},{key:"vao_valor_pesos",label:"Valor Unitario Pesos",sortable:!1,tdClass:"p-1 text-center",thClass:"p-1"}],orden_compra:{},muestra_alerta:!1,msj_alerta:"",formato_numero:/^[0-9]+([.][0-9]*)?$/}},mounted(){this.listarGlosas(),this.listarValorizacion()},methods:{async listarValorizacion(){this.cargando_pagina=!0,await axios.get(base_url+"valorizacion/listarValorizacion?id_valorizacion="+this.val_id_p).then(a=>{1==a.data.key?(this.valorizacion=JSON.parse(JSON.stringify(a.data.valorizacion)),this.orden_compra=a.data.valorizacion.orden_compra,this.muestra_calculos=!0):alert("Error al listar la valorización: "+a.data.msj),this.cargando_pagina=!1}).catch(a=>{alert("Error al listar la valorización: "+a),this.cargando_pagina=!1})},listarOrdenCompra(){if(""==this.buscar_oc)return;this.cargando_pagina=!0;const a=new URLSearchParams;a.append("orden_compra",this.buscar_oc),axios.post(base_url+"valorizacion/listarOrdenCompra",a).then(a=>{200==a.data.status?200==a.data.data.Cod?(this.orden_compra.oc=a.data.data.ocompra,this.orden_compra.bodega=a.data.data.bod,this.orden_compra.fecha=a.data.data.fecha,this.orden_compra.glosa=a.data.data.glosa,this.orden_compra.mensaje=a.data.data.mensaje,this.orden_compra.articulos=a.data.data.codigos,this.orden_compra.articulos.forEach(a=>{a.valorextra=0,a.totalextra=0,a.totalpesos=0,a.valorpesos=0}),console.log(this.orden_compra)):alert("Orden de compra no encontrada."):alert("Falló la conexion con CGI interno."),this.cargando_pagina=!1}).catch(a=>{this.cargando_pagina=!1})},agregarItem(){this.valorizacion.items.push({vco_id_glosa:"",vco_monto:"",vco_observacion:""})},eliminarItem(a){this.valorizacion.items.splice(a,1)},totalCostos(){if(!this.muestra_calculos)return 0;let a=0,t="";return this.valorizacion.items.forEach(e=>{let s=void 0!==e.vco_monto&&null!==e.vco_monto?e.vco_monto.toString():"";""!==s&&(t=s.replace(/\./g,"").replace(/,/g,"."),isNaN(parseFloat(t))||(a+=parseFloat(t)))}),this.valorizacion.val_total_gastos=a,a},porcentajeCostos(){let a=0,t=0,e=0,s="";if(a=this.totalCostos(),"number"===typeof parseFloat(this.valorizacion.val_comision_banco)&&""!=this.valorizacion.val_comision_banco&&(s=this.valorizacion.val_comision_banco.replace(/\./g,"").replace(/,/g,"."),t=parseFloat(s)),"number"===typeof parseFloat(this.valorizacion.val_costo_pagado)&&""!=this.valorizacion.val_costo_pagado&&(s=this.valorizacion.val_costo_pagado.replace(/\./g,"").replace(/,/g,"."),e=parseFloat(s)),0==a||0==t||0==e)return 0;let i=(a+t)/e;return this.valorizacion.val_porcentaje_costos=i,i},tipoCambio(){let a=0,t="",e=0,s=0;return"number"===typeof parseFloat(this.valorizacion.val_costo_pagado)&&""!=this.valorizacion.val_costo_pagado&&"number"===typeof parseFloat(this.valorizacion.val_costo_importacion)&&""!=this.valorizacion.val_costo_importacion?(t=this.valorizacion.val_costo_pagado.replace(/\./g,"").replace(/,/g,"."),s=parseFloat(t),t=this.valorizacion.val_costo_importacion.replace(/\./g,"").replace(/,/g,"."),e=parseFloat(t),a=s/e,this.valorizacion.val_tipo_cambio=a,a):0},tipoCambioReajustado(){let a=0;"number"===typeof this.valorizacion.val_tipo_cambio&&""!=this.valorizacion.val_tipo_cambio&&(a=parseFloat(this.valorizacion.val_tipo_cambio));let t=a+a*this.porcentajeCostos();return this.valorizacion.val_tipo_cambio_reajustado=t,t},reajustaValoresOC(){let a=0,t="",e=[];0!=this.tipoCambioReajustado()&&(e=JSON.parse(JSON.stringify(this.orden_compra.articulos)),e.forEach(e=>{0!=e.vao_valor_m_extranjera&&null!=e.vao_valor_m_extranjera&&""!=e.vao_valor_m_extranjera?(t=e.vao_valor_m_extranjera.replace(/\./g,"").replace(/,/g,"."),a=parseFloat(t),e.vao_total_extra=parseFloat(parseFloat(a*e.vao_cantidad).toFixed(2)),e.vao_total_pesos=parseInt(parseFloat(e.vao_total_extra*this.tipoCambioReajustado()).toFixed(2)),e.vao_valor_pesos=parseInt(parseFloat(e.vao_total_pesos/e.vao_cantidad).toFixed(2))):(e.vao_valor_m_extranjera=0,e.vao_total_extra=0,e.vao_total_pesos=0,e.vao_valor_pesos=0)}),this.orden_compra.articulos=e)},registrarGlosa(){if(""==this.nueva_glosa)return void alert("Debe ingresar una glosa.");this.cargando_pagina=!0;const a=new URLSearchParams;a.append("nueva_glosa",this.nueva_glosa),axios.post(base_url+"valorizacion/registrarGlosa",a).then(a=>{1==a.data.key?(this.listarGlosas(),this.modal_nueva_glosa=!1,this.nueva_glosa=""):alert("Error al registrar la glosa: "+a.data.msj),this.cargando_pagina=!1}).catch(a=>{alert("Error al registrar la glosa: "+a),this.cargando_pagina=!1})},listarGlosas(){this.cargando_pagina=!0,axios.get(base_url+"valorizacion/listarGlosas").then(a=>{1==a.data.key?this.glosas_valorizacion=a.data.glosas:alert("Falla al listar las glosas."),this.cargando_pagina=!1}).catch(a=>{alert("Falla al listar las glosas: "+a),this.cargando_pagina=!1})},guardarValorizacion(a=!1){this.cargando_pagina=!0;const t=new URLSearchParams;t.append("valorizacion",JSON.stringify(this.valorizacion)),t.append("orden_compra",JSON.stringify(this.orden_compra)),t.append("finalizar",JSON.stringify(a)),axios.post(base_url+"valorizacion/guardarValorizacion",t).then(a=>{1==a.data.key?(this.msj_registro="Valorización guardada correctamente.",this.modal_msj=!0):alert("Error al guardar la valorización: "+a.data.msj),this.cargando_pagina=!1}).catch(a=>{alert("Error al guardar la valorización: "+a),this.cargando_pagina=!1})},verificacionCorrecta(a){this.modal_verificar_huella=!1,"guardarValorizacion"==a?this.guardarValorizacion():"finalizarValorizacion"==a&&this.guardarValorizacion(!0)},formatearMiles(a){a=a.toString();let t=a.replace(/\./g,"").replace(/,/g,".");const e=parseFloat(t);return isNaN(e)?0:e.toLocaleString("de-DE")},cerrarValoricacion(){this.$emit("cerrar")}}},r=o,l=(e("7f76"),e("2877")),n=Object(l["a"])(r,s,i,!1,null,null,null);t["default"]=n.exports},"443f":function(a,t,e){},"448e":function(a,t,e){},4678:function(a,t,e){var s={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-ps":"4c98","./ar-ps.js":"4c98","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn-bd":"9686","./bn-bd.js":"9686","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-in":"ec2e","./en-in.js":"ec2e","./en-nz":"6f50","./en-nz.js":"6f50","./en-sg":"b7e9","./en-sg.js":"b7e9","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-mx":"b5b7","./es-mx.js":"b5b7","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fil":"d69a","./fil.js":"d69a","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-deva":"aaf2","./gom-deva.js":"aaf2","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku-kmr":"7558","./ku-kmr.js":"7558","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./oc-lnc":"167b","./oc-lnc.js":"167b","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tk":"5aff","./tk.js":"5aff","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-mo":"3a6c","./zh-mo.js":"3a6c","./zh-tw":"90ea","./zh-tw.js":"90ea"};function i(a){var t=o(a);return e(t)}function o(a){if(!e.o(s,a)){var t=new Error("Cannot find module '"+a+"'");throw t.code="MODULE_NOT_FOUND",t}return s[a]}i.keys=function(){return Object.keys(s)},i.resolve=o,a.exports=i,i.id="4678"},"4e9c":function(a,t,e){"use strict";e.r(t);var s=function(){var a=this,t=a._self._c;return t("b-modal",{attrs:{"hide-header":"","hide-footer":"",centered:"","no-close-on-esc":"","no-close-on-backdrop":"",size:"sm","body-text-variant":"primary","content-class":"bg-transparent border-0","body-bg-variant":"transparent"},model:{value:a.cargando_pagina,callback:function(t){a.cargando_pagina=t},expression:"cargando_pagina"}},[t("div",{staticClass:"text-center text-white my-2"},[t("div",{staticClass:"spinner-border",staticStyle:{width:"4rem",height:"4rem"},attrs:{role:"status"}}),t("br"),t("label",{staticClass:"text-white"},[a._v("CARGANDO...")])])])},i=[],o={props:["cargando_pagina"],data(){return{}},mounted(){},methods:{}},r=o,l=e("2877"),n=Object(l["a"])(r,s,i,!1,null,null,null);t["default"]=n.exports},"4fd3":function(a,t,e){"use strict";e.r(t);var s=function(){var a=this,t=a._self._c;return t("div",{staticClass:"container-fluid"},[t("b-modal",{attrs:{title:"VERIFICACIÓN BIOMETRICA",size:"lg","hide-footer":"","hide-header-close":"","no-close-on-backdrop":"","no-close-on-esc":""},on:{show:function(t){a.verificacion_correcta=a.verificacion_error=a.verificacion_incorrecta=!1},shown:function(t){return a.verificarHuella()}},model:{value:a.modal_verificar_huella,callback:function(t){a.modal_verificar_huella=t},expression:"modal_verificar_huella"}},[t("div",{staticClass:"container-fluid"},[a.verificacion_correcta||a.verificacion_incorrecta||a.verificacion_error?a._e():t("div",{staticClass:"row justify-content-center"},[t("div",{staticClass:"col-5 text-center pt-4 pb-3 animated infinite pulse"},[t("img",{staticClass:"img-fluid",attrs:{src:e("de34")}})]),t("div",{staticClass:"col-12 text-center"},[t("b-alert",{attrs:{variant:"primary",show:""}},[t("i",{staticClass:"fas fa-fingerprint mr-2"}),a._v("DIGITA TU HUELLA")])],1)]),a.verificacion_correcta?t("div",{staticClass:"row justify-content-center"},[t("div",{staticClass:"col-5 text-center pt-4 pb-3 animated zoomin"},[t("img",{staticClass:"img-fluid",attrs:{src:e("fbac")}})]),t("div",{staticClass:"col-12 text-center"},[t("b-alert",{attrs:{variant:"success",show:""}},[t("i",{staticClass:"fas fa-fingerprint mr-2"}),a._v("HUELLA CORRECTA")])],1)]):a._e(),a.verificacion_incorrecta?t("div",{staticClass:"row justify-content-center"},[t("div",{staticClass:"col-5 text-center pt-4 pb-3 animated zoomin"},[t("img",{staticClass:"img-fluid",attrs:{src:e("a1ff")}})]),t("div",{staticClass:"col-12 text-center"},[t("b-alert",{attrs:{variant:"warning",show:""}},[t("i",{staticClass:"fas fa-fingerprint mr-2"}),a._v("HUELLA INCORRECTA")])],1)]):a._e(),a.verificacion_error?t("div",{staticClass:"row justify-content-center"},[t("div",{staticClass:"col-5 text-center pt-4 pb-3 animated zoomin"},[t("img",{staticClass:"img-fluid",attrs:{src:e("a1ff")}})]),t("div",{staticClass:"col-12 text-center"},[t("b-alert",{attrs:{variant:"danger",show:""}},[t("i",{staticClass:"fas fa-fingerprint mr-2"}),a._v(a._s(a.verificacion_msj))])],1)]):a._e(),t("div",{staticClass:"row justify-content-center"},[t("div",{staticClass:"col-12 text-center"},[t("b-button",{attrs:{variant:"danger",size:"sm"},on:{click:function(t){return a.cerrarModalBiometria()}}},[a._v("CANCELAR")])],1)])])])],1)},i=[],o={props:["modal_verificar_huella","funcion_ejecucion"],name:"Biometria",data(){return{usuario:"",modal_verificar_huella:!1,verificacion_correcta:!1,verificacion_incorrecta:!1,verificacion_error:!1,verificacion_msj:"",interval_estado_v:null}},mounted(){},methods:{cerrarModalBiometria(){clearInterval(this.interval_estado_v),this.$emit("cerrar_modal_biometria"),$.ajax({url:"http://127.0.0.1/biometria/cancelar/cancelar.php"}).done(a=>{console.log(a)})},verificarHuella(){this.interval_estado_v=setInterval(()=>{$.ajax({url:"http://127.0.0.1/biometria/verificar/estado.php"}).done(a=>{"204"!=a.trim()&&204!=a.trim()||($("#ldr_verificacion").hide(),$("#msj_verificacion").show())})},300),axios.post(base_url+"biometria/listarHuellasUsuario").then(a=>{if(1==a.data.key){let t=a.data.huellas;null!=t.usb_huella1&&""!=t.usb_huella1||null!=t.usb_huella2&&""!=t.usb_huella2?$.ajax({type:"POST",url:"http://127.0.0.1/biometria/verificar/verificar.php",data:{huella1:t.usb_huella1,huella2:t.usb_huella2}}).done(a=>{clearInterval(this.interval_estado_v);var t=a.trim();"201"==t?(this.verificacion_correcta=!0,this.$emit("verificacion_correcta",this.funcion_ejecucion)):"202"==t||"201"!=t&&"202"!=t&&"203"!=t?(this.verificacion_error=!0,this.verificacion_msj="ERROR DE SISTEMA."):"203"==t&&(this.verificacion_incorrecta=!0)}).fail(()=>{clearInterval(this.interval_estado_v),this.verificacion_error=!0,this.verificacion_msj="ERROR DE CONEXIÓN CON TERMINAL."}):(clearInterval(this.interval_estado_v),this.verificacion_error=!0,this.verificacion_msj="NO SE ENCONTRARON HUELLAS REGISTRADAS.")}else clearInterval(this.interval_estado_v),this.verificacion_error=!0,this.verificacion_msj="NO SE ENCONTRORON REGISTROS."}).catch(a=>{clearInterval(this.interval_estado_v),this.verificacion_error=!0,this.verificacion_msj="ERROR DE CONEXIÓN CON SERVIDOR."})}}},r=o,l=e("2877"),n=Object(l["a"])(r,s,i,!1,null,"2024e95f",null);t["default"]=n.exports},"54d1":function(a,t,e){"use strict";e("2a51")},"56d7":function(a,t,e){"use strict";e.r(t);var s=e("2b0e"),i=function(){var a=this,t=a._self._c;return t("div",{attrs:{id:"app"}},[t("loader-component",{attrs:{cargando_pagina:a.cargando_pagina}}),t("div",{staticClass:"fixed-nav sticky-footer bg-dark sidenav-toggled",attrs:{id:"page-top"}},[t("nav",{staticClass:"navbar navbar-expand-lg navbar-dark bg-dark fixed-top pl-2",attrs:{id:"mainNav"}},[a._m(0),t("button",{staticClass:"navbar-toggler navbar-toggler-right",attrs:{type:"button","aria-expanded":"false","aria-label":"Toggle navigation"},on:{click:function(t){return a.muestraBarraSuperior()}}},[t("span",{staticClass:"navbar-toggler-icon"})]),t("div",{staticClass:"collapse navbar-collapse",attrs:{id:"navbarResponsive"}},[t("ul",{staticClass:"navbar-nav navbar-sidenav",staticStyle:{"min-width":"55px"},attrs:{id:"menuLateral"}},a._l(a.menu,(function(e,s){return t("li",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.right",modifiers:{hover:!0,right:!0}}],key:s,staticClass:"nav-item item_lateral",staticStyle:{"min-width":"55px"},attrs:{id:"item_"+e.nombre,title:e.nombre},on:{click:function(t){return a.cambiaVista(e.nombre)}}},[t("a",{staticClass:"nav-link",staticStyle:{cursor:"pointer"}},[t("span",{domProps:{innerHTML:a._s(e.icono)}}),a.barra?t("span",{staticClass:"nav-link-text texto_barra",domProps:{textContent:a._s(e.nombre)}}):a._e()])])})),0),t("ul",{staticClass:"navbar-nav sidenav-toggler"},[t("li",{staticClass:"nav-item item_lateral",staticStyle:{"min-width":"55px"}},[a.barra?t("a",{staticClass:"nav-link text-center",on:{click:function(t){return a.ocultaBarra()}}},[t("i",{staticClass:"fas fa-angle-left"})]):t("a",{staticClass:"nav-link text-center",on:{click:function(t){return a.muestraBarra()}}},[t("i",{staticClass:"fas fa-angle-right"})])])])])]),t("div",{staticClass:"content-wrapper"},[t("div",{staticClass:"mt-4"},[a.menu[0].visible?t("ingreso-bodega-component"):a._e(),a.menu[1].visible?t("salida-bodega-component"):a._e(),a.menu[2].visible?t("bodega-component"):a._e(),a.menu[3].visible?t("informes-bodega-component"):a._e(),a.menu[4].visible?t("valorizacion-component"):a._e()],1)]),a._m(1)]),t("b-modal",{attrs:{title:"CAMBIO DE CLAVE","hide-footer":"","no-close-on-backdrop":"","no-close-on-esc":""},model:{value:a.modal_cambiar_clave,callback:function(t){a.modal_cambiar_clave=t},expression:"modal_cambiar_clave"}},[t("div",{staticClass:"row"},[t("div",{staticClass:"col-2 pr-0"},[t("h6",{staticClass:"text-left"},[a._v("NOMBRE")])]),t("div",{staticClass:"col-1 p-0"},[t("h6",{staticClass:"text-center font-weight-light"},[a._v(":")])]),t("div",{staticClass:"col-9 pl-0"},[t("h6",{staticClass:"text-left font-weight-light text-uppercase"},[a._v(a._s(a.usuario.nombres+" "+a.usuario.apellidos))])])]),t("div",{staticClass:"row mb-3 pb-2 border-bottom"},[t("div",{staticClass:"col-2 pr-0"},[t("h6",{staticClass:"text-left"},[a._v("RUT")])]),t("div",{staticClass:"col-1 p-0"},[t("h6",{staticClass:"text-center font-weight-light"},[a._v(":")])]),t("div",{staticClass:"col-9 pl-0"},[""!=a.usuario.rut?t("h6",{staticClass:"text-left font-weight-light"},[a._v(a._s(a.formateaRut(a.usuario.rut+"-"+a.usuario.dv)))]):a._e()])]),t("h6",{staticClass:"text-left font-weight-bold"},[a._v("INGRESA TU CLAVE ACTUAL")]),t("div",{staticClass:"input-group mb-3"},[t("div",{staticClass:"input-group-prepend"},[t("span",{staticClass:"input-group-text"},[t("i",{staticClass:"fas fa-lock fa-fw"})])]),t("b-input",{staticClass:"form-control",attrs:{type:"password",placeholder:"Clave actual"},model:{value:a.usuario.clave_actual,callback:function(t){a.$set(a.usuario,"clave_actual",t)},expression:"usuario.clave_actual"}})],1),t("h6",{staticClass:"text-left font-weight-bold mt-4"},[a._v("NUEVA CLAVE")]),t("div",{staticClass:"input-group mb-3"},[t("div",{staticClass:"input-group-prepend"},[t("span",{staticClass:"input-group-text"},[t("i",{staticClass:"fas fa-lock fa-fw"})])]),t("b-input",{staticClass:"form-control",attrs:{type:"password",placeholder:"Ingresa una clave de seguridad",state:a.validaClave(a.usuario.clave_nueva1)},model:{value:a.usuario.clave_nueva1,callback:function(t){a.$set(a.usuario,"clave_nueva1",t)},expression:"usuario.clave_nueva1"}})],1),t("div",{staticClass:"input-group mb-3"},[t("div",{staticClass:"input-group-prepend"},[t("span",{staticClass:"input-group-text"},[t("i",{staticClass:"fas fa-lock fa-fw"})])]),t("b-input",{staticClass:"form-control",attrs:{disabled:!a.validaClave(a.usuario.clave_nueva1),type:"password",placeholder:"Reingresa tu nueva clave",state:a.validaClave(a.usuario.clave_nueva1)&&a.usuario.clave_nueva1==a.usuario.clave_nueva2},model:{value:a.usuario.clave_nueva2,callback:function(t){a.$set(a.usuario,"clave_nueva2",t)},expression:"usuario.clave_nueva2"}})],1),t("h6",{staticClass:"text-center font-weight-bold mt-2"},[t("i",{staticClass:"fas fa-exclamation-circle fa-fw"}),a._v(" "),t("span",{staticClass:"font-weight-light"},[a._v("La nueva clave debe contener mayúsculas, minúsculas y números, con un mínimo de 6 caracteres de largo.")])]),t("div",{staticClass:"row justify-content-beteween border-top pt-3"},[t("div",{staticClass:"col-6"},[t("button",{staticClass:"btn btn-block btn-sm btn-danger",on:{click:function(t){a.modal_cambiar_clave=!1,a.usuario={clave_actual:"",clave_nueva1:"",clave_nueva2:""}}}},[t("i",{staticClass:"fas fa-times fa-fw mr-2"}),a._v("CANCELAR")])]),t("div",{staticClass:"col-6"},[t("button",{staticClass:"btn btn-block btn-sm btn-success",attrs:{disabled:!a.validaInputsClave()},on:{click:function(t){return a.guardaClave()}}},[t("i",{staticClass:"fas fa-check fa-fw mr-2"}),a._v("GUARDAR")])])])]),t("b-modal",{attrs:{title:"CERRAR SESIÓN",footer:!1,"hide-footer":""},model:{value:a.modal_cerrar_sesion,callback:function(t){a.modal_cerrar_sesion=t},expression:"modal_cerrar_sesion"}},[t("h5",{staticClass:"text-center"},[a._v("¿SEGURO QUE DESEA SALIR?")]),t("div",{staticClass:"row justify-content-between border-top pt-1 mt-4"},[t("div",{staticClass:"col-lg-5 col-md-6 col-sm-12 mt-2"},[t("button",{staticClass:"btn btn-secondary btn-sm btn-block",on:{click:function(t){a.modal_cerrar_sesion=!1}}},[t("i",{staticClass:"fas fa-ban"}),a._v(" CANCELAR")])]),t("div",{staticClass:"col-lg-5 col-md-6 col-sm-12 mt-2"},[t("button",{staticClass:"btn btn-primary btn-sm btn-block",on:{click:function(t){return a.cerrarSesion()}}},[t("i",{staticClass:"fas fa-sign-out-alt"}),a._v(" CERRAR SESIÓN")])])])])],1)},o=[function(){var a=this,t=a._self._c;return t("a",{staticClass:"navbar-brand",attrs:{href:"<?=base_url?>"}},[t("i",{staticClass:"fas fa-warehouse fa-fw fa-lg mr-3 ml-1"}),a._v("BODEGA CENTRAL")])},function(){var a=this,t=a._self._c;return t("a",{staticClass:"scroll-to-top rounded",staticStyle:{"margin-bottom":"55px"},attrs:{href:"#page-top"}},[t("i",{staticClass:"fas fa-angle-up"})])}],r={name:"App",data(){return{id_electrocom:2,num_empresa:0,num_bodega:0,nom_empresa:"",nom_bodega:"",barra:!1,menu:[{nombre:"Ingreso",visible:!1,icono:'<i class="fas fa-fw mr-2 fa-box"></i>'},{nombre:"Salida",visible:!1,icono:'<i class="fas fa-fw mr-2 fa-truck"></i>'},{nombre:"Bodega",visible:!1,icono:'<i class="fas fa-fw mr-2 fa-warehouse"></i>'},{nombre:"Informes",visible:!1,icono:'<i class="fas fa-fw mr-2 fa-file-alt"></i>'},{nombre:"Valorizacion",visible:!1,icono:'<i class="fas fa-fw mr-2 fa-dollar-sign"></i>'}],modal_cambiar_clave:!1,modal_cerrar_sesion:!1,usuario:{rut:"",dv:"",nombres:"",apellidos:"",clave_actual:"",clave_nueva1:"",clave_nueva2:"",admin:!1},cargando_pagina:!1,seccion:"Ingreso"}},mounted(){""!=this.getParameterByName("menu")?this.cambiaVista(this.getParameterByName("menu")):this.cambiaVista("Ingreso"),this.ocultaBarra(),this.intervaloSesion=setInterval(this.validaSesion,1e4)},methods:{validaInputsClave(){return!!(""!=this.usuario.clave_actual&&this.usuario.clave_nueva1==this.usuario.clave_nueva2&&this.usuario.clave_nueva1.length>5&&this.validaClave(this.usuario.clave_nueva1))},validaClave(a){var t=/^(?=.*\d)(?=.*[a-záéíóúüñ]).*[A-ZÁÉÍÓÚÜÑ]/;return!!(t.test(a)&&a.length>5)},validaSesion(){axios.get(base_url+"home/estadoSesion").then(a=>{if(200===a.status){var t=a.data;1!=t.key&&window.location.reload()}})},obtieneDatosUsuario(){this.cargando_pagina=!0,axios.post(base_url+"Perfil/obtieneDatosUsuario").then(a=>{if(200===a.status){var t=a.data;1==t.key&&(this.cargando_pagina=!1,this.usuario.rut=t.usb_rut,this.usuario.dv=t.usb_dv,this.usuario.nombres=t.usb_nombres,this.usuario.apellidos=t.usb_apellidos,this.usuario.usuario=t.usb_usuario,this.usuario.administrador=t.usb_administrador,this.usuario.administrativo=t.usb_administrativo,this.usuario.administrador||this.usuario.administrativo?this.menu=this.menu_admin:this.menu=this.menu_personal,setTimeout(()=>{this.cambiaVista(0)},1)),this.cargando_pagina=!1}else this.cargando_pagina=!1,this.modal_cambiar_clave=!1,this.muestraToast("ERROR","ERROR AL CARGAS DATOS NECESARIOS, INTENTELO MAS TARDE.","danger")})},guardaClave(){this.cargando_pagina=!0;var a=new URLSearchParams;a.append("clave_actual",sha1(md5(this.usuario.rut+this.usuario.clave_actual))),a.append("clave_nueva",sha1(md5(this.usuario.rut+this.usuario.clave_nueva1))),axios.post(base_url+"Perfil/cambiaClave",a).then(a=>{if(200===a.status&&"resp"in a.data){var t=a.data.resp;1==t.key?(this.cargando_pagina=!1,this.modal_cambiar_clave=!1,this.usuario.clave_actual="",this.usuario.clave_nueva1="",this.usuario.clave_nueva2="",this.muestraToast("ÉXITO","CLAVE CAMBIADA CON ÉXITO.","success")):2==t.key?(this.cargando_pagina=!1,this.muestraToast("ATENCIÓN","LA CLAVE ACTUAL INGRESADA NO ES CORRECTA.","danger")):0==t.key&&(this.cargando_pagina=!1,this.muestraToast("ERROR","ERROR AL REALIZAR CAMBIOS, INTENTELO MAS TARDE.","danger"))}else this.cargando_pagina=!1,this.muestraToast("ERROR","ERROR AL REALIZAR CAMBIOS, INTENTELO MAS TARDE.","danger")})},ocultaBarra(){$("#menuLateral").css("width","55px"),$(".item_lateral").css("width","55px"),$(".content-wrapper").css("margin-left","55px"),this.barra=!1,console.log("ocultando menu")},muestraBarra(){$("#menuLateral").css("width","250px"),$(".item_lateral").css("width","250px"),$(".content-wrapper").css("margin-left","250px"),this.barra=!0,console.log("mostrando menu")},cambiaVista(a){history.pushState(null,"","?menu="+a);for(var t=0;t<this.menu.length;t++)this.menu[t].nombre==a?this.menu[t].visible=!0:this.menu[t].visible=!1;$(".item_lateral").removeClass("active"),$("#item_"+a).addClass("active"),this.ocultaMenu()},ocultaMenu(){$("#navbarResponsive").hide(100)},muestraBarraSuperior(){$("#navbarResponsive").toggle(100)},setEmpresa(){axios.post(base_url+"sucursal/setempresa").then(a=>{this.num_empresa=a.data.dts_empresa,this.num_bodega=a.data.dts_bodega,this.nom_empresa=a.data.emp_nombre,this.nom_bodega=a.data.bod_nombre})},getParameterByName(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+a+"=([^&#]*)"),e=t.exec(location.search);return null===e?"":decodeURIComponent(e[1].replace(/\+/g," "))}}},l=r,n=(e("c215"),e("54d1"),e("2877")),c=Object(n["a"])(l,i,o,!1,null,"48ceab5e",null),d=c.exports,_=e("bc3a"),p=e.n(_),u=e("1157"),v=e.n(u),m=e("0deb"),f=e.n(m),b=e("5f5b"),h=(e("c1df"),{install(a,t){a.yourMethod=a=>a,a.mixin({created(){},methods:{muestraToast(a,t,e=null,s="b-toaster-bottom-right"){this.$bvToast.toast(t,{title:a,variant:e,toaster:s,autoHideDelay:5e3,solid:!0})},cerrarSesion(){axios.post(base_url+"Login/cerrarSesion").then(a=>{200===a.status&&"resp"in a.data?(a.data.resp.key,location.reload()):location.reload()}).catch(a=>{location.reload()})},validaSesion(){axios.post(base_url+"login/validaSesion").then(a=>{if(200===a.status&&"resp"in a.data){var t=a.data.resp;1!=t.key&&this.cerrarSesion()}})},formateaFecha(a){return a.replace(/^(\d{4})-(\d{2})-(\d{2})$/g,"$3-$2-$1")},formateaRut(a){const t=a.replace(/\./g,"").replace(/[^k|K|\d]/g,"").replace(/\-/g,"").trim().toUpperCase(),e=t.substr(-1,1),s=t.substr(0,t.length-1);let i="";var o=0,r=1;for(o=s.length-1;o>=0;o--){const a=s.charAt(o);i=a.concat(i),r%3==0&&r<=s.length-1&&(i=".".concat(i)),r++}var l="";return l=i.length>0?i.concat("-").concat(e):e,l},verificaRut(a){let t=!1;if(null!=a&&a.toString().length>=11){let e=a.substring(a.length-1,a.length);if(a=a.replace(/[.|-]/g,"").slice(0,-1),-1==a.indexOf("K")){let s=0,i=1;for(;a;a=Math.floor(a/10))i=(i+a%10*(9-s++%6))%11;let o=(i?i-1:"K").toString();o===e&&(t=!0)}}return t}}}),a.prototype.$myProperty="This is a Vue instance property."}}),g=e("4a7a"),C=e.n(g);e("becf"),e("5b52"),e("0d50"),e("0958"),e("448e"),e("ab8b"),e("2dd8"),e("6dfc");s["default"].use(b["a"]),s["default"].use(h),window.$=window.jQuery=v.a,window.axios=p.a,window.bootstrap=f.a,window.Vue=e("2b0e"),e("c59e"),window.base_url="index.php/",document.title="Bodega Central",s["default"].component("loader-component",e("4e9c").default),s["default"].component("biometria-component",e("4fd3").default),s["default"].component("bodega-component",e("be69").default),s["default"].component("ingreso-bodega-component",e("947d").default),s["default"].component("salida-bodega-component",e("9001").default),s["default"].component("informes-bodega-component",e("6e66").default),s["default"].component("valorizacion-component",e("9f260").default),s["default"].component("nueva-valorizacion-component",e("86c8").default),s["default"].component("ver-valorizacion-component",e("3e74").default),s["default"].component("lista-valorizaciones-component",e("3c2c").default),s["default"].component("v-select",C.a),new s["default"]({render:function(a){return a(d)}}).$mount("#app")},"6e66":function(a,t,e){"use strict";e.r(t);var s=function(){var a=this,t=a._self._c;return t("div",{staticClass:"container-fluid"},[t("loader-component",{attrs:{cargando_pagina:a.cargando_pagina}}),a._m(0),t("div",{staticClass:"row px-2"},[t("div",{staticClass:"card w-100"},[t("div",{staticClass:"card-header"},[t("div",{staticClass:"row justify-content-center mt-4"},[t("div",{staticClass:"col-6 text-rigth"},[t("b-form-select",{staticClass:"mb-3",attrs:{options:a.informes,size:"sm"},model:{value:a.informe_seleccionado,callback:function(t){a.informe_seleccionado=t},expression:"informe_seleccionado"}})],1),t("div",{staticClass:"col-3 text-left"},[t("b-button",{attrs:{disabled:!a.validaFiltros(),variant:"primary",size:"sm"},on:{click:function(t){return a.listarInforme()}}},[a._v("BUSCAR")])],1)]),2==a.informe_seleccionado||3==a.informe_seleccionado?t("div",{staticClass:"row"},[t("div",{staticClass:"col-6"},[t("b-form-datepicker",{staticClass:"mb-3",attrs:{size:"sm",placeholder:"Fecha desde","label-help":"Selecciona un día.","label-no-date-selected":"-","label-next-month":"SIGUIENTE MES","label-prev-month":"MES ANTERIOR","label-prev-year":"AÑO ANTERIOR","label-next-year":"SIGUIENTE AÑO","label-current-month":"MES ACTUAL","start-weekday":"1"},model:{value:a.filtro_fecha_desde,callback:function(t){a.filtro_fecha_desde=t},expression:"filtro_fecha_desde"}})],1),t("div",{staticClass:"col-6"},[t("b-form-datepicker",{staticClass:"mb-3",attrs:{size:"sm",placeholder:"Fecha hasta","label-help":"Selecciona un día.","label-no-date-selected":"-","label-next-month":"SIGUIENTE MES","label-prev-month":"MES ANTERIOR","label-prev-year":"AÑO ANTERIOR","label-next-year":"SIGUIENTE AÑO","label-current-month":"MES ACTUAL","start-weekday":"1"},model:{value:a.filtro_fecha_hasta,callback:function(t){a.filtro_fecha_hasta=t},expression:"filtro_fecha_hasta"}})],1)]):a._e()]),t("div",{staticClass:"card-content"},[a.articulos_bodega.length>0&&a.informe_seleccionado<3?t("b-table",{attrs:{striped:"",hover:"",items:a.articulos_bodega,fields:a.columnas_articulos,"thead-tr-class":"text-center align-middle bg-dark text-white"},scopedSlots:a._u([{key:"cell(ari_cantidad)",fn:function(e){return[t("span",[a._v(a._s(e.value+" "+e.item.ari_unidad_medida.toLowerCase()))])]}},{key:"cell(ing_rack)",fn:function(e){return[t("span",[a._v(a._s(e.item.esp_seccion+"-"+e.item.esp_estante+"-"+e.item.esp_numero))])]}}],null,!1,2444196978)}):a._e(),a.articulos_bodega.length>0&&3==a.informe_seleccionado?t("b-table",{attrs:{striped:"",hover:"",items:a.articulos_bodega,fields:a.columnas_articulos_salida,"thead-tr-class":"text-center align-middle bg-dark text-white"},scopedSlots:a._u([{key:"cell(ari_cantidad)",fn:function(e){return[t("span",[a._v(a._s(e.value+" "+e.item.ari_unidad_medida.toLowerCase()))])]}},{key:"cell(ing_rack)",fn:function(e){return[t("span",[a._v(a._s(e.item.esp_seccion+"-"+e.item.esp_estante+"-"+e.item.esp_numero))])]}}],null,!1,2444196978)}):a._e(),""==a.informe_seleccionado?t("b-alert",{staticClass:"text-center m-3",attrs:{show:"",variant:"info"}},[a._v("Sin informe seleccionado.")]):a._e(),0==a.articulos_bodega.length?t("b-alert",{staticClass:"text-center m-3",attrs:{show:"",variant:"warning"}},[a._v("Sin datos para listar.")]):a._e()],1)])])],1)},i=[function(){var a=this,t=a._self._c;return t("div",{staticClass:"row"},[t("div",{staticClass:"col-12 text-md-left text-center"},[t("h3",[t("i",{staticClass:"fas fa-fw fa-file-alt mr-2"}),a._v("INFORMES DE BODEGA")])])])}],o={data(){return{cargando_pagina:!1,informe_seleccionado:"",filtro_fecha_desde:"",filtro_fecha_hasta:"",informes:[{value:"",text:"Selecciona un informe"},{value:1,text:"Articulos en bodega"},{value:2,text:"Ingresos por fecha"},{value:3,text:"Salidas por fecha"}],columnas_articulos:[{key:"ari_codigo",label:"SKU",sortable:!0,tdClass:"p-1",thClass:"p-1"},{key:"ari_nombre",label:"Articulo",sortable:!0,tdClass:"p-1",thClass:"p-1"},{key:"ari_cantidad",label:"Cantidad",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"},{key:"ing_fecha_ingreso",label:"Fecha Ingreso",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"},{key:"ing_despacho_estimado",label:"Despacho Estimado",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"},{key:"ing_rack",label:"Estante",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"},{key:"ing_id",label:"N° Ingreso",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"},{key:"ing_orden_compra",label:"OC",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"}],columnas_articulos_salida:[{key:"ari_codigo",label:"SKU",sortable:!0,tdClass:"p-1",thClass:"p-1"},{key:"ari_nombre",label:"Articulo",sortable:!0,tdClass:"p-1",thClass:"p-1"},{key:"ars_cantidad",label:"Cantidad",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"},{key:"ing_fecha_ingreso",label:"Fecha Ingreso",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"},{key:"sld_fecha_salida",label:"Fecha Salida",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"},{key:"sld_bodega_destino",label:"Sucursal Dest.",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"},{key:"ing_rack",label:"Estante",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"},{key:"ing_orden_compra",label:"OC",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"},{key:"ing_id",label:"N° Ingreso",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"},{key:"sld_id",label:"N° Salida",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"},{key:"sld_orden_traspaso",label:"N° Ord. Traspaso",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"}],articulos_bodega:[]}},mounted(){this.fecha_actual=new Date},methods:{listarInforme(){this.cargando_pagina=!0;const a=new URLSearchParams;a.append("tipo_informe",this.informe_seleccionado),2!=this.informe_seleccionado&&3!=this.informe_seleccionado||(a.append("fecha_desde",this.filtro_fecha_desde),a.append("fecha_hasta",this.filtro_fecha_hasta)),axios.post(base_url+"bodega/listarInforme",a).then(a=>{this.articulos_bodega=a.data,console.log(a.data),this.cargando_pagina=!1}).catch(a=>{console.log(a),this.cargando_pagina=!1})},validaFiltros(){return""!=this.informe_seleccionado&&(2!=this.informe_seleccionado&&3!=this.informe_seleccionado||""!=this.filtro_fecha_desde&&""!=this.filtro_fecha_hasta)}}},r=o,l=e("2877"),n=Object(l["a"])(r,s,i,!1,null,null,null);t["default"]=n.exports},"7f76":function(a,t,e){"use strict";e("443f")},"853c":function(a,t,e){},"86c8":function(a,t,e){"use strict";e.r(t);var s=function(){var a=this,t=a._self._c;return t("div",{staticClass:"container-fluid p-0"},[t("loader-component",{attrs:{cargando_pagina:a.cargando_pagina}}),t("biometria-component",{attrs:{modal_verificar_huella:a.modal_verificar_huella,funcion_ejecucion:a.funcion_verificar},on:{verificacion_correcta:a.verificacionCorrecta,cerrar_modal_biometria:function(t){a.modal_verificar_huella=!1}}}),t("div",{staticClass:"row justify-content-center mt-4"},[t("div",{staticClass:"col-12"},[t("b-card",[t("div",{staticClass:"container-fluid p-0 mb-3"},[t("div",{staticClass:"row justify-content-end mb-3"},[t("div",{staticClass:"col text-left"},[t("h4",[a._v("Nueva valorización")])]),t("div",{staticClass:"col-xl-2 col-md-3 col-6"},[t("b-button",{attrs:{variant:"danger",size:"sm",block:""},on:{click:function(t){a.modal_confirmar_cancelar=!0}}},[t("i",{staticClass:"fas fa-times mr-2"}),a._v("CANCELAR")])],1),t("div",{staticClass:"col-xl-2 col-md-3 col-6"},[t("b-button",{attrs:{variant:"primary",size:"sm",block:""},on:{click:function(t){a.funcion_verificar="registrarValorizacion",a.modal_verificar_huella=!0}}},[t("i",{staticClass:"fas fa-save mr-2"}),a._v("GUARDAR")])],1),t("div",{staticClass:"col-xl-2 col-md-3 col-6"},[t("b-button",{attrs:{variant:"success",size:"sm",block:""},on:{click:function(t){a.modal_confirmar_finalizar=!0}}},[t("i",{staticClass:"fas fa-chevron-circle-right mr-2"}),a._v("FINALIZAR")])],1)]),t("div",{staticClass:"row justify-content-center"},[t("div",{staticClass:"col-xl-4 col-md-6 col-12 mb-2"},[t("b-input-group",{attrs:{prepend:"Factura",size:"sm"}},[t("b-form-input",{attrs:{placeholder:"Ej. 14322"},model:{value:a.valorizacion.factura,callback:function(t){a.$set(a.valorizacion,"factura",t)},expression:"valorizacion.factura"}})],1)],1),t("div",{staticClass:"col-xl-4 col-md-6 col-12 mb-2"},[t("b-input-group",{attrs:{prepend:"DIN",size:"sm"}},[t("b-form-input",{attrs:{placeholder:"Ej. 14322"},model:{value:a.valorizacion.din,callback:function(t){a.$set(a.valorizacion,"din",t)},expression:"valorizacion.din"}})],1)],1),t("div",{staticClass:"col-xl-4 col-md-6 col-12 mb-2"},[t("b-input-group",{attrs:{prepend:"Rut Carpeta",size:"sm"}},[t("b-form-input",{attrs:{placeholder:"Ej. 14322"},model:{value:a.valorizacion.rut_carpeta,callback:function(t){a.$set(a.valorizacion,"rut_carpeta",t)},expression:"valorizacion.rut_carpeta"}})],1)],1),t("div",{staticClass:"col-xl-4 col-md-6 col-12 mb-2"},[t("b-input-group",{attrs:{prepend:"Costo Importacion (moneda extranjera)",size:"sm"}},[t("b-form-input",{attrs:{placeholder:"Ej. 14322"},on:{input:function(t){a.valorizacion.costo_importacion=a.formatearMiles(a.valorizacion.costo_importacion),a.reajustaValoresOC()},change:function(t){return a.tipoCambio()}},model:{value:a.valorizacion.costo_importacion,callback:function(t){a.$set(a.valorizacion,"costo_importacion",t)},expression:"valorizacion.costo_importacion"}})],1)],1),t("div",{staticClass:"col-xl-4 col-md-6 col-12 mb-2"},[t("b-input-group",{attrs:{prepend:"CIF Pagado (pesos)",size:"sm"}},[t("b-form-input",{attrs:{placeholder:"Ej. 14322"},on:{input:function(t){a.valorizacion.costo_pagado=a.formatearMiles(a.valorizacion.costo_pagado),a.reajustaValoresOC()},change:function(t){return a.tipoCambio()}},model:{value:a.valorizacion.costo_pagado,callback:function(t){a.$set(a.valorizacion,"costo_pagado",t)},expression:"valorizacion.costo_pagado"}})],1)],1),t("div",{staticClass:"col-xl-4 col-md-6 col-12 mb-2"},[t("b-input-group",{attrs:{prepend:"Comisión Banco $ ",size:"sm"}},[t("b-form-input",{attrs:{placeholder:"Ej. 14322"},on:{input:function(t){a.valorizacion.comision_banco=a.formatearMiles(a.valorizacion.comision_banco),a.reajustaValoresOC()}},model:{value:a.valorizacion.comision_banco,callback:function(t){a.$set(a.valorizacion,"comision_banco",t)},expression:"valorizacion.comision_banco"}})],1)],1)])]),t("b-table",{staticClass:"rounded",attrs:{striped:"",hover:"",items:a.valorizacion.items,fields:a.columnas_valorizacion,"thead-tr-class":"text-center align-middle bg-dark text-white"},scopedSlots:a._u([{key:"cell(glosa)",fn:function(e){return[t("b-form-select",{attrs:{options:a.glosas_valorizacion,size:"sm","value-field":"glo_id","text-field":"glo_glosa"},model:{value:e.item.glosa,callback:function(t){a.$set(e.item,"glosa",t)},expression:"data.item.glosa"}})]}},{key:"cell(monto)",fn:function(e){return[t("b-form-input",{attrs:{size:"sm"},on:{input:function(t){e.item.monto=a.formatearMiles(e.item.monto),a.reajustaValoresOC()}},model:{value:e.item.monto,callback:function(t){a.$set(e.item,"monto",t)},expression:"data.item.monto"}})]}},{key:"cell(observacion)",fn:function(e){return[t("b-form-input",{attrs:{size:"sm"},on:{keyup:function(t){return!t.type.indexOf("key")&&a._k(t.keyCode,"enter",13,t.key,"Enter")?null:a.actualizarObservacion(e.item.id)}},model:{value:e.item.observacion,callback:function(t){a.$set(e.item,"observacion",t)},expression:"data.item.observacion"}})]}},{key:"cell(opcion)",fn:function(e){return[t("div",{staticClass:"w-100 text-center"},[e.index>0?t("b-button",{attrs:{size:"sm",variant:"danger"},on:{click:function(t){return a.eliminarItem(e.index)}}},[t("i",{staticClass:"fas fa-trash-alt"})]):a._e()],1)]}},{key:"head(opcion)",fn:function(e){return[t("div",{staticClass:"w-100 text-center"},[t("b-button",{attrs:{variant:"primary",size:"sm",block:""},on:{click:function(t){return a.agregarItem()}}},[t("i",{staticClass:"fas fa-plus fa-fw"})])],1)]}}])}),t("div",{staticClass:"row justify-content-center"},[t("div",{staticClass:"col-xl-3 col-md-4 col-6"},[t("b-button",{attrs:{variant:"outline-success",size:"sm",block:""},on:{click:function(t){a.modal_nueva_glosa=!0}}},[t("i",{staticClass:"fas fa-plus mr-2"}),a._v("CREAR NUEVA GLOSA")])],1)]),t("div",{staticClass:"row mt-2"},[t("div",{staticClass:"col-12 text-right"},[t("table",{staticClass:"ml-auto"},[t("tr",[t("td",[a._v("Total gastos de importación : ")]),t("td",[t("b",{domProps:{textContent:a._s("$ "+a.totalCostos().toLocaleString("de-DE"))}})])]),t("tr",[t("td",[a._v("Tipo de cambio inicial : ")]),t("td",[t("b",{domProps:{textContent:a._s("$ "+parseFloat(parseFloat(a.tipoCambio().toFixed(2))).toLocaleString("de-DE"))}})])]),t("tr",[t("td",[a._v("% Gasto S/Import. : ")]),t("td",[t("b",{domProps:{textContent:a._s("% "+100*parseFloat(parseFloat(a.porcentajeCostos()).toFixed(2)))}})])]),t("tr",[t("td",[a._v("Tipo de cambio reajustado : ")]),t("td",[t("b",{domProps:{textContent:a._s("$ "+parseFloat(parseFloat(a.tipoCambioReajustado()).toFixed(2)).toLocaleString("de-DE"))}})])])])])])],1)],1),t("div",{staticClass:"col-12"},[t("b-card",{staticClass:"mt-4"},[t("div",{staticClass:"container-fluid p-0 mb-3"},[t("div",{staticClass:"row justify-content-end mb-3"},[t("div",{staticClass:"col text-left"},[t("h4",[a._v("Orden de compra "+a._s(a.orden_compra.oc))])])])]),t("table",{staticClass:"w-100"},[t("td",[t("tr",[t("strong",{staticClass:"pr-3"},[a._v("Fecha")]),a._v(":"),t("span",{staticClass:"pl-3"},[a._v(a._s(a.orden_compra.fecha))])])]),t("td",[t("tr",[t("strong",{staticClass:"pr-3"},[a._v("Bodega")]),a._v(":"),t("span",{staticClass:"pl-3"},[a._v(a._s(a.orden_compra.bodega))])])]),t("td",[t("tr",[t("strong",{staticClass:"pr-3"},[a._v("Glosa")]),a._v(":"),t("span",{staticClass:"pl-3"},[a._v(a._s(a.orden_compra.glosa))])])])]),""!=a.orden_compra.mensaje?t("h6",[t("strong",[a._v("Mensaje:")]),a._v(" "+a._s(a.orden_compra.mensaje))]):a._e(),t("b-table",{staticClass:"mt-2",attrs:{striped:"",hover:"",items:a.orden_compra.articulos,fields:a.columnas_articulos,"thead-tr-class":"text-center align-middle bg-dark text-white"},scopedSlots:a._u([{key:"cell(codigo)",fn:function(t){return[a._v(" "+a._s(t.item.codigo+"-"+t.item.ver)+" ")]}},{key:"cell(cant)",fn:function(t){return[a._v(" "+a._s(t.value.toLocaleString("de-DE"))+" ")]}},{key:"cell(valorextra)",fn:function(e){return[t("b-form-input",{attrs:{size:"sm"},on:{input:function(t){e.item.valorextra=a.formatearMiles(e.item.valorextra),a.reajustaValoresOC()}},model:{value:e.item.valorextra,callback:function(t){a.$set(e.item,"valorextra",t)},expression:"data.item.valorextra"}})]}},{key:"cell(totalextra)",fn:function(t){return[a._v(" "+a._s(t.value.toLocaleString("de-DE"))+" ")]}},{key:"cell(totalpesos)",fn:function(t){return[a._v(" "+a._s(t.value.toLocaleString("de-DE"))+" ")]}},{key:"cell(valorpesos)",fn:function(t){return[a._v(" "+a._s(t.value.toLocaleString("de-DE"))+" ")]}}])})],1)],1)]),t("b-modal",{attrs:{size:"md",title:"NUEVA GLOSA","hide-footer":"","no-close-on-backdrop":"",scrollable:!1},model:{value:a.modal_nueva_glosa,callback:function(t){a.modal_nueva_glosa=t},expression:"modal_nueva_glosa"}},[t("div",{staticClass:"row"},[t("div",{staticClass:"col-12"},[t("h6",[a._v("Nueva glosa:")]),t("b-form-input",{attrs:{placeholder:"Ej. Gastos extra."},model:{value:a.nueva_glosa,callback:function(t){a.nueva_glosa=t},expression:"nueva_glosa"}})],1)]),t("div",{staticClass:"row mt-3 pt-3 border-top justify-content-center"},[t("div",{staticClass:"col-4 text-center"},[t("b-button",{attrs:{variant:"danger",size:"sm"},on:{click:function(t){a.modal_nueva_glosa=!1,a.nueva_glosa=""}}},[t("i",{staticClass:"fas fa-ban fa-fw ml-2"}),a._v("CANCELAR")])],1),t("div",{staticClass:"col-4 text-center"},[t("b-button",{attrs:{variant:"success",size:"sm"},on:{click:function(t){return a.registrarGlosa()}}},[t("i",{staticClass:"fas fa-save fa-fw ml-2"}),a._v("REGISTRAR")])],1)])]),t("b-modal",{attrs:{size:"md",title:"CANCELAR","hide-footer":"","no-close-on-backdrop":"",scrollable:!1},model:{value:a.modal_confirmar_cancelar,callback:function(t){a.modal_confirmar_cancelar=t},expression:"modal_confirmar_cancelar"}},[t("div",{staticClass:"row"},[t("div",{staticClass:"col-12 text-center"},[t("h5",[a._v("¿Confirma que desea cancelar la creación de la nueva valorización?")])])]),t("div",{staticClass:"row mt-3 pt-3 border-top justify-content-center"},[t("div",{staticClass:"col-4 text-center"},[t("b-button",{attrs:{variant:"danger",size:"sm"},on:{click:function(t){a.modal_confirmar_cancelar=!1,a.nueva_glosa=""}}},[t("i",{staticClass:"fas fa-ban fa-fw mr-2"}),a._v("CANCELAR")])],1),t("div",{staticClass:"col-4 text-center"},[t("b-button",{attrs:{variant:"success",size:"sm"},on:{click:function(t){return a.cerrarNuevaValoricacion()}}},[t("i",{staticClass:"fas fa-check-circle fa-fw mr-2"}),a._v("CONFIRMAR")])],1)])]),t("b-modal",{attrs:{size:"md",title:"FINALIZAR","hide-footer":"","no-close-on-backdrop":"",scrollable:!1},model:{value:a.modal_confirmar_finalizar,callback:function(t){a.modal_confirmar_finalizar=t},expression:"modal_confirmar_finalizar"}},[t("div",{staticClass:"row"},[t("div",{staticClass:"col-12 text-center"},[t("h5",[a._v("¿Confirma que desea finalizar la valorización?")])])]),t("div",{staticClass:"row mt-3 pt-3 border-top justify-content-center"},[t("div",{staticClass:"col-4 text-center"},[t("b-button",{attrs:{variant:"danger",size:"sm"},on:{click:function(t){a.modal_confirmar_finalizar=!1,a.nueva_glosa=""}}},[t("i",{staticClass:"fas fa-ban fa-fw mr-2"}),a._v("CANCELAR")])],1),t("div",{staticClass:"col-4 text-center"},[t("b-button",{attrs:{variant:"success",size:"sm"},on:{click:function(t){a.funcion_verificar="finalizarValorizacion",a.modal_verificar_huella=!0}}},[t("i",{staticClass:"fas fa-check-circle fa-fw mr-2"}),a._v("FINALIZAR")])],1)])]),t("b-modal",{attrs:{size:"lg",title:"REGISTRO VALORIZACIÓN","hide-footer":"","no-close-on-backdrop":"",scrollable:!1},model:{value:a.modal_msj,callback:function(t){a.modal_msj=t},expression:"modal_msj"}},[t("div",{staticClass:"row"},[t("div",{staticClass:"col-12"},[t("h6",{staticClass:"text-center"},[t("strong",[a._v(a._s(a.msj_registro))])])])]),t("div",{staticClass:"row mt-3 pt-3 border-top"},[t("div",{staticClass:"col text-center"},[t("b-button",{attrs:{variant:"primary",size:"sm"},on:{click:function(t){return a.cerrarNuevaValoricacion()}}},[a._v("ACEPTAR")])],1)])])],1)},i=[],o={props:["orden_compra_p"],data(){return{cargando_pagina:!1,modal_verificar_huella:!1,funcion_verificar:"",modal_msj:!1,msj_registro:"",fecha_actual:"",columnas_valorizacion:[{key:"glosa",label:"Glosa",sortable:!1,tdClass:"p-1",thClass:"p-1"},{key:"observacion",label:"Observacion",sortable:!1,tdClass:"p-1",thClass:"p-1"},{key:"monto",label:"Monto",sortable:!1,tdClass:"p-1",thClass:"p-1"},{key:"opcion",label:"-",sortable:!1,tdClass:"p-1",thClass:"p-1"}],valorizacion:{factura:"",din:"",rut_carpeta:"",comision_banco:"",costo_importacion:"",costo_pagado:"",total_gastos:"",tipo_cambio:"",porcentaje_costos:"",tipo_cambio_reajustado:"",items:[{glosa:"",monto:"",observacion:""}]},modal_confirmar_cancelar:!1,modal_confirmar_finalizar:!1,modal_nueva_glosa:!1,nueva_glosa:"",glosas_valorizacion:[],columnas_articulos:[{key:"codigo",label:"Codigo",sortable:!1,tdClass:"p-1",thClass:"p-1"},{key:"nomart",label:"Articulo",sortable:!1,tdClass:"p-1",thClass:"p-1"},{key:"umed",label:"U. Medida",sortable:!1,tdClass:"p-1 text-center",thClass:"p-1"},{key:"cant",label:"Cantidad",sortable:!1,tdClass:"p-1 text-center",thClass:"p-1"},{key:"valorextra",label:"Valor Unitario M. Extranjera",sortable:!1,tdClass:"p-1 text-center",thClass:"p-1"},{key:"totalextra",label:"Total M. Extranjera",sortable:!1,tdClass:"p-1 text-center",thClass:"p-1"},{key:"totalpesos",label:"Total Pesos",sortable:!1,tdClass:"p-1 text-center",thClass:"p-1"},{key:"valorpesos",label:"Valor Unitario Pesos",sortable:!1,tdClass:"p-1 text-center",thClass:"p-1"}],orden_compra:{},muestra_alerta:!1,msj_alerta:"",formato_numero:/^[0-9]+([.][0-9]*)?$/}},mounted(){this.orden_compra=JSON.parse(JSON.stringify(this.orden_compra_p)),this.fecha_actual=new Date,this.filtro_fecha_hasta=new Date,this.filtro_fecha_desde=new Date(this.filtro_fecha_hasta.getTime()-2592e6),this.filtro_fecha_desde=this.filtro_fecha_desde.getFullYear()+"-"+(this.filtro_fecha_desde.getMonth()+1)+"-"+this.filtro_fecha_desde.getDate(),this.filtro_fecha_hasta=this.filtro_fecha_hasta.getFullYear()+"-"+(this.filtro_fecha_hasta.getMonth()+1)+"-"+this.filtro_fecha_hasta.getDate(),this.listarGlosas()},methods:{listarOrdenCompra(){if(""==this.buscar_oc)return;this.cargando_pagina=!0;const a=new URLSearchParams;a.append("orden_compra",this.buscar_oc),axios.post(base_url+"valorizacion/listarOrdenCompra",a).then(a=>{200==a.data.status?200==a.data.data.Cod?(this.orden_compra.oc=a.data.data.ocompra,this.orden_compra.bodega=a.data.data.bod,this.orden_compra.fecha=a.data.data.fecha,this.orden_compra.glosa=a.data.data.glosa,this.orden_compra.mensaje=a.data.data.mensaje,this.orden_compra.articulos=a.data.data.codigos,this.orden_compra.articulos.forEach(a=>{a.valorextra=0,a.totalextra=0,a.totalpesos=0,a.valorpesos=0}),console.log(this.orden_compra)):alert("Orden de compra no encontrada."):alert("Falló la conexion con CGI interno."),this.cargando_pagina=!1}).catch(a=>{this.cargando_pagina=!1})},agregarItem(){this.valorizacion.items.push({glosa:"",monto:"",observacion:""})},eliminarItem(a){this.valorizacion.items.splice(a,1)},totalCostos(){let a=0,t="";return this.valorizacion.items.forEach(e=>{"number"===typeof parseFloat(e.monto)&&""!=e.monto&&(t=e.monto.replace(/\./g,"").replace(/,/g,"."),a+=parseFloat(t))}),this.valorizacion.total_gastos=a,a},porcentajeCostos(){let a=0,t=0,e=0,s="";if(a=this.totalCostos(),"number"===typeof parseFloat(this.valorizacion.comision_banco)&&""!=this.valorizacion.comision_banco&&(s=this.valorizacion.comision_banco.replace(/\./g,"").replace(/,/g,"."),t=parseFloat(s)),"number"===typeof parseFloat(this.valorizacion.costo_pagado)&&""!=this.valorizacion.costo_pagado&&(s=this.valorizacion.costo_pagado.replace(/\./g,"").replace(/,/g,"."),e=parseFloat(s)),0==a||0==t||0==e)return 0;let i=(a+t)/e;return this.valorizacion.porcentaje_costos=i,i},tipoCambio(){let a=0,t="",e=0,s=0;return"number"===typeof parseFloat(this.valorizacion.costo_pagado)&&""!=this.valorizacion.costo_pagado&&"number"===typeof parseFloat(this.valorizacion.costo_importacion)&&""!=this.valorizacion.costo_importacion?(t=this.valorizacion.costo_pagado.replace(/\./g,"").replace(/,/g,"."),s=parseFloat(t),t=this.valorizacion.costo_importacion.replace(/\./g,"").replace(/,/g,"."),e=parseFloat(t),a=s/e,this.valorizacion.tipo_cambio=a,a):0},tipoCambioReajustado(){let a=0;"number"===typeof this.valorizacion.tipo_cambio&&""!=this.valorizacion.tipo_cambio&&(a=parseFloat(this.valorizacion.tipo_cambio));let t=a+a*this.porcentajeCostos();return this.valorizacion.tipo_cambio_reajustado=t,t},reajustaValoresOC(){let a=0,t="",e=[];0!=this.tipoCambioReajustado()&&(e=JSON.parse(JSON.stringify(this.orden_compra.articulos)),e.forEach(e=>{0!=e.valorextra&&null!=e.valorextra&&""!=e.valorextra?(t=e.valorextra.replace(/\./g,"").replace(/,/g,"."),a=parseFloat(t),e.totalextra=parseFloat(parseFloat(a*e.cant).toFixed(2)),e.totalpesos=parseFloat(parseFloat(e.totalextra*this.tipoCambioReajustado()).toFixed(2)),e.valorpesos=parseFloat(parseFloat(e.totalpesos/e.cant).toFixed(2))):(e.valorextra=0,e.totalextra=0,e.totalpesos=0,e.valorpesos=0)}),this.orden_compra.articulos=e)},registrarGlosa(){if(""==this.nueva_glosa)return void alert("Debe ingresar una glosa.");this.cargando_pagina=!0;const a=new URLSearchParams;a.append("nueva_glosa",this.nueva_glosa),axios.post(base_url+"valorizacion/registrarGlosa",a).then(a=>{1==a.data.key?(this.listarGlosas(),this.modal_nueva_glosa=!1,this.nueva_glosa=""):alert("Error al registrar la glosa: "+a.data.msj),this.cargando_pagina=!1}).catch(a=>{alert("Error al registrar la glosa: "+a),this.cargando_pagina=!1})},listarGlosas(){this.cargando_pagina=!0,axios.get(base_url+"valorizacion/listarGlosas").then(a=>{1==a.data.key?this.glosas_valorizacion=a.data.glosas:alert("Falla al listar las glosas."),this.cargando_pagina=!1}).catch(a=>{alert("Falla al listar las glosas: "+a),this.cargando_pagina=!1})},registrarValorizacion(a=!1){this.cargando_pagina=!0;const t=new URLSearchParams;t.append("valorizacion",JSON.stringify(this.valorizacion)),t.append("orden_compra",JSON.stringify(this.orden_compra)),t.append("finalizar",JSON.stringify(a)),axios.post(base_url+"valorizacion/registrarValorizacion",t).then(a=>{1==a.data.key?(this.msj_registro="Valorización guardada correctamente.",this.modal_msj=!0):alert("Error al guardar la valorización: "+a.data.msj),this.cargando_pagina=!1}).catch(a=>{alert("Error al guardar la valorización: "+a),this.cargando_pagina=!1})},formatearMiles(a){a=a.toString();let t=a.replace(/\./g,"").replace(/,/g,".");const e=parseFloat(t);return isNaN(e)?0:e.toLocaleString("de-DE")},verificacionCorrecta(a){this.modal_verificar_huella=!1,"registrarValorizacion"==a?this.registrarValorizacion():"finalizarValorizacion"==a&&this.registrarValorizacion(!0)},cerrarNuevaValoricacion(){this.$emit("cerrar")}}},r=o,l=(e("88a7"),e("2877")),n=Object(l["a"])(r,s,i,!1,null,null,null);t["default"]=n.exports},"88a7":function(a,t,e){"use strict";e("0048")},9001:function(a,t,e){"use strict";e.r(t);var s=function(){var a=this,t=a._self._c;return t("div",{staticClass:"container-fluid"},[t("loader-component",{attrs:{cargando_pagina:a.cargando_pagina}}),t("div",{staticClass:"row"},[a._m(0),t("div",{staticClass:"col-xl-4 col-lg-4 col-md-4 col-sm-12 mt-sm-2 mt-md-0 text-md-right text-center"},[t("b-button",{attrs:{variant:"success",size:"sm"},on:{click:function(t){a.modal_historial=!0}}},[t("i",{staticClass:"fas fa-fw fa-history mr-2"}),a._v("HISTORIAL DE SALIDAS")])],1)]),t("div",{staticClass:"row px-2"},[t("div",{staticClass:"card w-100"},[t("div",{staticClass:"card-header"},[t("h5",[a._v("Solicitudes de traspaso")]),t("div",{staticClass:"row justify-content-center mt-2"},[t("div",{staticClass:"col-6 text-rigth"},[a._v(" Filtrar por bodega: "),t("b-form-select",{staticClass:"mb-3",attrs:{size:"sm",options:a.sucursales,"value-field":"suc_id","text-field":"suc_nombre"},on:{change:function(t){return a.listarOrdenesTraspaso()}},model:{value:a.filtro_bodega,callback:function(t){a.filtro_bodega=t},expression:"filtro_bodega"}},[t("b-form-select-option",{attrs:{value:"",selected:""}},[a._v("TODAS")])],1)],1),t("div",{staticClass:"col-6"},[a._v(" Busqueda: "),t("div",{staticClass:"input-group input-group-sm"},[t("input",{directives:[{name:"model",rawName:"v-model",value:a.filtro_busqueda,expression:"filtro_busqueda"}],staticClass:"form-control form-control-sm h-auto",attrs:{type:"text",placeholder:"BÚSQUEDA"},domProps:{value:a.filtro_busqueda},on:{input:function(t){t.target.composing||(a.filtro_busqueda=t.target.value)}}}),t("div",{staticClass:"input-group-append"},[t("button",{staticClass:"btn btn-sm btn-secondary",attrs:{disabled:""==a.filtro_busqueda},on:{click:function(t){a.filtro_busqueda=""}}},[""==a.filtro_busqueda?t("i",{staticClass:"fa-fw fas fa-search"}):t("i",{staticClass:"fa-fw fas fa-times"})])])])])])]),t("div",{staticClass:"card-content"},[a.ordenes_traspaso.length>0?t("b-table",{attrs:{striped:"",hover:"",items:a.ordenes_traspaso,fields:a.columnas_ordenes,filter:a.filtro_busqueda,"thead-tr-class":"text-center align-middle bg-dark text-white"},scopedSlots:a._u([{key:"cell(ing_rack)",fn:function(e){return[t("span",[a._v(a._s(e.item.esp_seccion+"-"+e.item.esp_estante+"-"+e.item.esp_numero))])]}},{key:"cell(opcion)",fn:function(e){return[t("b-button",{attrs:{size:"sm",variant:"primary"},on:{click:function(t){a.listarOrdenTraspaso(e.item.documento),a.orden_seleccionada=e.item,a.modal_ver_orden=!0}}},[a._v("VER")])]}}],null,!1,2713319292)}):a._e(),0==a.ordenes_traspaso.length?t("b-alert",{staticClass:"text-center m-3",attrs:{show:"",variant:"warning"}},[a._v("Sin datos para listar.")]):a._e()],1)])]),t("b-modal",{attrs:{title:"Solicitud de traspaso",size:"xl","hide-footer":"","no-close-on-backdrop":""},model:{value:a.modal_ver_orden,callback:function(t){a.modal_ver_orden=t},expression:"modal_ver_orden"}},[""!=a.orden_seleccionada&&a.orden_seleccionada.detalle?t("div",[t("h6",[t("strong",[a._v("Solicitud de traspaso:")]),a._v(" "+a._s(a.orden_seleccionada.documento))]),t("h6",[t("strong",[a._v("Fecha: ")]),a._v(a._s(a.orden_seleccionada.fecha))]),t("h6",[t("strong",[a._v("Bodega destino: ")]),a._v(a._s(a.orden_seleccionada.bod+" - "+a.orden_seleccionada.nombod))]),t("h6",[t("strong",[a._v("Observacion: ")]),a._v(a._s(a.orden_seleccionada.detalle.mensaje))]),t("h6",[t("strong",[a._v("Articulos: ")])]),a.armando_salida?t("b-table",{attrs:{striped:"",hover:"",items:a.orden_seleccionada.detalle.codigos,fields:a.columnas_articulos_orden2,"thead-tr-class":"text-center align-middle bg-dark text-white"},scopedSlots:a._u([{key:"cell(cant_salida)",fn:function(e){return[e.item.estantes.length>0?t("b-form-input",{class:{"is-invalid":!a.validaNumero(e.item.cant_salida)||parseInt(e.item.cant_salida)>parseInt(e.item.cant)},attrs:{type:"text",size:"sm"},model:{value:e.item.cant_salida,callback:function(t){a.$set(e.item,"cant_salida",t)},expression:"data.item.cant_salida"}}):a._e()]}},{key:"cell(estante)",fn:function(e){return[t("div",{staticClass:"container-fluid"},a._l(e.item.estantes_seleccionados,(function(s,i){return t("div",{key:i+"est",staticClass:"row"},[t("div",{staticClass:"col-5 pr-0"},[e.item.estantes.length>0?t("b-form-input",{class:{"is-invalid":!a.validaNumero(s.cantidad)||!a.validaCantidadEstante(e.item)},attrs:{type:"text",size:"sm"},on:{change:function(t){a.agregaEstante(),s.id_articulo_ingreso=""},blur:function(t){return a.agregaEstante()},keyup:function(t){return!t.type.indexOf("key")&&a._k(t.keyCode,"enter",13,t.key,"Enter")?null:a.agregaEstante()}},model:{value:s.cantidad,callback:function(t){a.$set(s,"cantidad",t)},expression:"est.cantidad"}}):a._e()],1),t("div",{staticClass:"col-6 px-1"},[0==e.item.estantes.length?t("h6",{staticClass:"text-danger mt-1"},[a._v("Sin Stock.")]):t("b-form-select",{class:{"is-invalid":!a.validaEstante(e.item)},attrs:{size:"sm"},model:{value:s.id_articulo_ingreso,callback:function(t){a.$set(s,"id_articulo_ingreso",t)},expression:"est.id_articulo_ingreso"}},a._l(e.item.estantes,(function(e){return t("b-form-select-option",{directives:[{name:"key",rawName:"v-key",value:e.esp_id+"esp",expression:"estante.esp_id+'esp'"}],attrs:{disabled:!a.desactivaEstante(e),value:e.ari_id},domProps:{textContent:a._s("["+e.esp_estante+"-"+e.esp_seccion+"-"+e.esp_numero+"] [ "+e.ari_cantidad+" "+e.ari_unidad_medida+" ]")}})})),1)],1),t("div",{staticClass:"col-1 ml-0 pl-0"},[i>0?t("b-button",{attrs:{size:"sm",variant:"danger"},on:{click:function(a){return e.item.estantes_seleccionados.splice(i,1)}}},[a._v("X")]):a._e()],1)])})),0)]}}],null,!1,3717618176)}):t("b-table",{attrs:{striped:"",hover:"",items:a.orden_seleccionada.detalle.codigos,fields:a.columnas_articulos_orden,"thead-tr-class":"text-center align-middle bg-dark text-white"}}),a.armando_salida?t("h6",[a._v("Observacion")]):a._e(),a.armando_salida?t("b-form-textarea",{model:{value:a.orden_seleccionada.detalle.mensaje_nuevo,callback:function(t){a.$set(a.orden_seleccionada.detalle,"mensaje_nuevo",t)},expression:"orden_seleccionada.detalle.mensaje_nuevo"}}):a._e()],1):a._e(),t("div",{staticClass:"mt-3 pt-3 border-top text-center"},[a.armando_salida?a._e():t("b-button",{attrs:{variant:"success",size:"sm"},on:{click:function(t){a.armando_salida=!0}}},[a._v("Crear Salida de Bodega")]),a.armando_salida?t("b-button",{attrs:{variant:"danger",size:"sm"},on:{click:function(t){a.armando_salida=!1}}},[a._v("Cancelar")]):a._e(),a.armando_salida?t("b-button",{staticClass:"ml-2",attrs:{disabled:!a.validaDatos(),variant:"success",size:"sm"},on:{click:function(t){return a.registrarSalida()}}},[a._v("Registrar Salida")]):a._e()],1)]),t("b-modal",{attrs:{title:"Historial de salidas",size:"xl","no-close-on-backdrop":"","content-class":"alto-modal"},scopedSlots:a._u([{key:"modal-footer",fn:function(){return[t("div",{staticClass:"text-center w-100"},[t("b-button",{attrs:{variant:"danger",size:"sm"},on:{click:function(t){a.modal_historial=!1}}},[a._v("Cerrar")])],1)]},proxy:!0}]),model:{value:a.modal_historial,callback:function(t){a.modal_historial=t},expression:"modal_historial"}},[t("b-card",{staticClass:"mb-2"},[t("div",{staticClass:"row pb-2 mb-2 border-bottom"},[t("div",{staticClass:"col-12"},[t("b-form-group",{attrs:{label:"Filtrar por:"}},[t("b-form-radio-group",{attrs:{id:"radio-group-1",options:a.tipos_filtro,name:"radio-options"},model:{value:a.tipo_filtro_historial,callback:function(t){a.tipo_filtro_historial=t},expression:"tipo_filtro_historial"}})],1)],1)]),1==a.tipo_filtro_historial?t("div",{staticClass:"row"},[t("div",{staticClass:"col-6"},[t("h6",[a._v("Desde")]),t("b-form-datepicker",{attrs:{size:"sm",placeholder:"SELECCIONA FECHA","label-help":"Selecciona un día.","label-no-date-selected":"-","label-next-month":"SIGUIENTE MES","label-prev-month":"MES ANTERIOR","label-prev-year":"AÑO ANTERIOR","label-next-year":"SIGUIENTE AÑO","label-current-month":"MES ACTUAL","start-weekday":"1"},model:{value:a.filtro_fecha_desde,callback:function(t){a.filtro_fecha_desde=t},expression:"filtro_fecha_desde"}})],1),t("div",{staticClass:"col-6"},[t("h6",[a._v("Hasta")]),t("b-form-datepicker",{attrs:{size:"sm",placeholder:"SELECCIONA FECHA","label-help":"Selecciona un día.","label-no-date-selected":"-","label-next-month":"SIGUIENTE MES","label-prev-month":"MES ANTERIOR","label-prev-year":"AÑO ANTERIOR","label-next-year":"SIGUIENTE AÑO","label-current-month":"MES ACTUAL","start-weekday":"1"},model:{value:a.filtro_fecha_hasta,callback:function(t){a.filtro_fecha_hasta=t},expression:"filtro_fecha_hasta"}})],1)]):a._e(),2==a.tipo_filtro_historial?t("div",{staticClass:"row justify-content-center"},[t("div",{staticClass:"col-6"},[t("h6",[a._v("Ingresa el N° de la salida")]),t("b-form-input",{attrs:{size:"sm",placeholder:"id salida"},model:{value:a.filtro_id_salida,callback:function(t){a.filtro_id_salida=t},expression:"filtro_id_salida"}})],1)]):a._e(),3==a.tipo_filtro_historial?t("div",{staticClass:"row justify-content-center"},[t("div",{staticClass:"col-6"},[t("h6",[a._v("Ingresa el N° de la Solicitud de traspaso")]),t("b-form-input",{attrs:{size:"sm",placeholder:"Solicitud de traspaso"},model:{value:a.filtro_orden_traspaso,callback:function(t){a.filtro_orden_traspaso=t},expression:"filtro_orden_traspaso"}})],1)]):a._e(),t("div",{staticClass:"row text-center"},[t("div",{staticClass:"col-12 mt-2"},[t("b-button",{attrs:{disabled:2==a.tipo_filtro_historial&&""==a.filtro_id_salida||3==a.tipo_filtro_historial&&""==a.filtro_orden_traspaso,variant:"success",size:"sm"},on:{click:function(t){return a.listarHistorialSalidas()}}},[t("i",{staticClass:"fas fa-fw fa-search mr-2"}),a._v("Filtrar")])],1)])]),t("div",[a.historial_salidas.length>0?t("b-table",{attrs:{striped:"",hover:"",items:a.historial_salidas,fields:a.columnas_historial,"thead-tr-class":"text-center align-middle bg-dark text-white"},scopedSlots:a._u([{key:"cell(sld_fecha_salida)",fn:function(t){return[a._v(" "+a._s(t.value.split(" ")[0].split("-")[2]+"/"+t.value.split(" ")[0].split("-")[1]+"/"+t.value.split(" ")[0].split("-")[0]+" "+t.value.split(" ")[1].split(":")[0]+":"+t.value.split(" ")[1].split(":")[1])+" ")]}},{key:"cell(opcion)",fn:function(e){return[t("b-button",{attrs:{variant:"primary",size:"sm"},on:{click:function(t){return a.listarDetalleSalida(e.item.sld_id)}}},[a._v("VER")])]}}],null,!1,1547458915)}):t("b-alert",{staticClass:"text-center",attrs:{show:"",variant:"info"}},[a._v("Sin resultados.")])],1)],1),t("b-modal",{attrs:{title:"Detalle de salida",size:"lg"},scopedSlots:a._u([{key:"modal-footer",fn:function(){return[t("div",{staticClass:"text-center w-100"},[t("b-button",{attrs:{variant:"danger",size:"sm"},on:{click:function(t){a.modal_detalle_salida=!1}}},[a._v("Cerrar")])],1)]},proxy:!0}]),model:{value:a.modal_detalle_salida,callback:function(t){a.modal_detalle_salida=t},expression:"modal_detalle_salida"}},[""!=a.detalle_salida?t("div",{staticClass:"w-100"},[t("h6",[t("strong",[a._v("N° Salida:")]),a._v(" "+a._s(a.detalle_salida.sld_id))]),t("h6",[t("strong",[a._v("Fecha:")]),a._v(" "+a._s(a.detalle_salida.sld_fecha_salida.split(" ")[0].split("-")[2]+"/"+a.detalle_salida.sld_fecha_salida.split(" ")[0].split("-")[1]+"/"+a.detalle_salida.sld_fecha_salida.split(" ")[0].split("-")[0]+" "+a.detalle_salida.sld_fecha_salida.split(" ")[1].split(":")[0]+":"+a.detalle_salida.sld_fecha_salida.split(" ")[1].split(":")[1]))]),t("h6",[t("strong",[a._v("Bodega destino:")]),a._v(" "+a._s(a.detalle_salida.sld_bodega_destino))]),t("h6",[t("strong",[a._v("Observación:")]),a._v(" "+a._s(a.detalle_salida.sld_observacion))]),t("h6",[t("strong",[a._v("Solicitud de traspaso:")]),a._v(" "+a._s(a.detalle_salida.sld_orden_traspaso))])]):a._e(),t("b-table",{attrs:{striped:"",hover:"",items:a.detalle_salida.articulos,fields:a.columnas_detalle_salida,"thead-tr-class":"text-center align-middle bg-dark text-white"},scopedSlots:a._u([{key:"cell(ari_espacio)",fn:function(t){return[a._v(" "+a._s(t.item.esp_estante+"-"+t.item.esp_seccion+"-"+t.item.esp_numero)+" ")]}}])})],1)],1)},i=[function(){var a=this,t=a._self._c;return t("div",{staticClass:"col-xl-8 col-lg-8 col-md-8 col-sm-12 text-md-left text-center"},[t("h3",[t("i",{staticClass:"fas fa-fw fa-truck mr-2"}),a._v("SALIDA DE BODEGA")])])}],o={data(){return{cargando_pagina:!1,sucursales:[],salida:{sucursal:"",articulos:""},articulos:[],tipos_documentos:[{value:33,text:"FACTURA"},{value:39,text:"BOLETA"},{value:52,text:"GUIA DESPACHO"}],filtro_bodega:"",filtro_busqueda:"",ordenes_traspaso:[],columnas_ordenes:[{key:"documento",label:"Documento",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"},{key:"fecha",label:"Fecha",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"},{key:"bod",label:"Bodega",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"},{key:"nombod",label:"Nombre Bodega",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"},{key:"opcion",label:"-",tdClass:"p-1 text-center",thClass:"p-1"}],columnas_articulos_orden:[{key:"codigo",label:"SKU",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"},{key:"nomart",label:"Nombre",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"},{key:"umed",label:"U. Medida",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"},{key:"cant",label:"Cantidad",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"}],columnas_articulos_orden2:[{key:"codigo",label:"SKU",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"},{key:"nomart",label:"Nombre",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"},{key:"umed",label:"U. Medida",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"},{key:"cant",label:"Cantidad Solicitada",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"},{key:"cant_salida",label:"Cantidad Salida",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"},{key:"estante",label:"Cantidad x Estante",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"}],columnas_historial:[{key:"sld_id",label:"N° Salida",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"},{key:"sld_fecha_salida",label:"Fecha",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"},{key:"sld_bodega_destino",label:"Bodega destino",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"},{key:"sld_observacion",label:"Observacion",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"},{key:"sld_orden_traspaso",label:"Solicitud traspaso",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"},{key:"opcion",label:"-",tdClass:"p-1 text-center",thClass:"p-1"}],orden_seleccionada:"",modal_ver_orden:!1,armando_salida:!1,modal_historial:!1,filtro_fecha_desde:"",filtro_fecha_hasta:"",filtro_id_salida:"",filtro_orden_traspaso:"",historial_salidas:[],tipos_filtro:[{text:"Fechas",value:1},{text:"N° Salida",value:2},{text:"Orden traspaso",value:3}],tipo_filtro_historial:1,modal_detalle_salida:!1,detalle_salida:"",columnas_detalle_salida:[{key:"ari_codigo",label:"SKU",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"},{key:"ari_nombre",label:"Nombre",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"},{key:"ari_unidad_medida",label:"U. Medida",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"},{key:"ars_cantidad",label:"Cantidad",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"},{key:"ari_espacio",label:"Estante",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"}],soloNum:/^[0-9]*$/}},mounted(){this.listarSucursales(),this.listarOrdenesTraspaso(),this.filtro_fecha_hasta=new Date,this.filtro_fecha_desde=new Date(this.filtro_fecha_hasta.getTime()-2592e6),this.filtro_fecha_desde=this.filtro_fecha_desde.getFullYear()+"-"+(this.filtro_fecha_desde.getMonth()+1)+"-"+this.filtro_fecha_desde.getDate(),this.filtro_fecha_hasta=this.filtro_fecha_hasta.getFullYear()+"-"+(this.filtro_fecha_hasta.getMonth()+1)+"-"+this.filtro_fecha_hasta.getDate()},methods:{listarSucursales(){this.cargando_pagina=!0,axios.post(base_url+"bodega/listarSucursales").then(a=>{this.sucursales=a.data}).catch(a=>{console.log(a),this.cargando_pagina=!1})},listarProductosSucursal(){this.cargando_pagina=!0;const a=new URLSearchParams;a.append("id_sucursal",this.salida.sucursal),axios.post(base_url+"bodega/listarProductosSucursal",a).then(a=>{this.articulos=a.data,this.cargando_pagina=!1}).catch(a=>{console.log(a),this.cargando_pagina=!1})},listarOrdenesTraspaso(){this.cargando_pagina=!0;const a=new URLSearchParams;a.append("bodega",this.filtro_bodega),axios.post(base_url+"bodega/listarOrdenesTraspaso",a).then(a=>{200==a.data.status?this.ordenes_traspaso=a.data.sotrasp:alert("Error al listar solicitudes de traspaso."),this.cargando_pagina=!1}).catch(a=>{console.log(a),this.cargando_pagina=!1})},listarOrdenTraspaso(a){this.cargando_pagina=!0;const t=new URLSearchParams;t.append("id_orden",a),axios.post(base_url+"bodega/listarOrdenTraspaso",t).then(a=>{200==a.data.status?this.orden_seleccionada.detalle=a.data:alert("Error al listar solicitud de traspaso."),this.cargando_pagina=!1}).catch(a=>{console.log(a),this.cargando_pagina=!1})},listarHistorialSalidas(){this.cargando_pagina=!0;const a=new URLSearchParams;a.append("tipo_filtro",this.tipo_filtro_historial),a.append("fecha_desde",this.filtro_fecha_desde),a.append("fecha_hasta",this.filtro_fecha_hasta),a.append("id_salida",this.filtro_id_salida),a.append("orden_traspaso",this.filtro_orden_traspaso),axios.post(base_url+"bodega/listarHistorialSalidas",a).then(a=>{this.historial_salidas=a.data,this.cargando_pagina=!1}).catch(a=>{console.log(a),alert("Error al listar historial de salidas."),this.cargando_pagina=!1})},listarDetalleSalida(a){this.cargando_pagina=!0;const t=new URLSearchParams;t.append("id_salida",a),axios.post(base_url+"bodega/listarDetalleSalida",t).then(a=>{this.detalle_salida=a.data,this.modal_detalle_salida=!0,this.cargando_pagina=!1}).catch(a=>{console.log(a),alert("Error al listar detalle historial de salidas."),this.cargando_pagina=!1})},validaDatos(){var a=!0;return this.orden_seleccionada.detalle.codigos.forEach(t=>{(parseInt(t.cant_salida)<=0||""==t.cant_salida||parseInt(t.cant_salida)>parseInt(t.cant))&&(a=!1);let e=0;t.estantes_seleccionados.forEach(s=>{e+=parseInt(s.cantidad),(s.cantidad<=0||""==s.cantidad||""==s.id_articulo_ingreso||parseInt(s.cantidad)>parseInt(t.cant))&&(a=!1)}),parseInt(e)>parseInt(t.cant_salida)&&(a=!1),t.estantes_seleccionados.forEach(e=>{t.estantes.forEach(t=>{e.id_articulo_ingreso==t.ari_id&&parseInt(e.cantidad)>parseInt(t.ari_cantidad)&&(a=!1)})})}),a},validaNumero(a){return this.soloNum.test(a)},validaEstante(a){let t=!0;return a.estantes_seleccionados.forEach(e=>{a.estantes.forEach(a=>{e.id_articulo_ingreso==a.ari_id&&parseInt(e.cantidad)>parseInt(a.ari_cantidad)&&(t=!1)})}),t},validaCantidadEstante(a){let t=!0,e=0;return a.estantes_seleccionados.forEach(a=>{e+=parseInt(a.cantidad)}),e>parseInt(a.cant_salida)&&(t=!1),t},desactivaEstante(a){let t=!0;return this.orden_seleccionada.detalle.codigos.forEach(e=>{e.estantes_seleccionados.forEach(e=>{e.id_articulo_ingreso==a.ari_id&&(t=!1)})}),t},agregaEstante(){let a=!1;this.orden_seleccionada.detalle.codigos.forEach(t=>{let e=0;if(t.estantes_seleccionados.forEach(t=>{e+=parseInt(t.cantidad),0==parseInt(t.cantidad)&&(a=!0)}),e<parseInt(t.cant_salida)&&!a&&t.estantes_seleccionados.push({id_articulo_ingreso:"",cantidad:0}),e>parseInt(t.cant)){t.estantes_seleccionados.pop();for(let a=t.estantes_seleccionados.length;a>e;a--)t.estantes_seleccionados.pop()}})},registrarSalida(){this.cargando_pagina=!0;const a=new URLSearchParams;a.append("salida",JSON.stringify(this.orden_seleccionada)),axios.post(base_url+"bodega/registrarSalida",a).then(a=>{1==a.data.key?(alert("Salida registrada correctamente."),this.modal_ver_orden=!1,this.listarOrdenesTraspaso()):alert(a.data.msj),this.cargando_pagina=!1}).catch(a=>{console.log(a),this.cargando_pagina=!1})},fechaPasada(a){const t=new Date(a),e=new Date;return t<e}}},r=o,l=(e("1b23"),e("2877")),n=Object(l["a"])(r,s,i,!1,null,null,null);t["default"]=n.exports},"947d":function(a,t,e){"use strict";e.r(t);var s=function(){var a=this,t=a._self._c;return t("div",{staticClass:"container-fluid"},[t("loader-component",{attrs:{cargando_pagina:a.cargando_pagina}}),t("div",{staticClass:"row"},[a._m(0),t("div",{staticClass:"col-xl-4 col-lg-4 col-md-4 col-sm-12 mt-sm-2 mt-md-0 text-md-right text-center"},[t("b-button",{attrs:{variant:"success",size:"sm"},on:{click:function(t){a.modal_historial=!0}}},[t("i",{staticClass:"fas fa-fw fa-history mr-2"}),a._v("HISTORIAL DE INGRESOS")])],1)]),""==a.nuevo_ingreso.oc?t("b-card",{staticClass:"mt-4"},[t("h5",[a._v("Nuevo ingreso de bodega")]),t("div",{staticClass:"row justify-content-center mt-4"},[t("div",{staticClass:"col-xl-6 col-md-10 col-12"},[a._v(" Ingresa orden de compra: "),t("b-form-input",{staticClass:"mb-3",attrs:{size:"sm"},on:{keyup:function(t){return!t.type.indexOf("key")&&a._k(t.keyCode,"enter",13,t.key,"Enter")?null:a.listarOrdenCompra()}},model:{value:a.buscar_oc,callback:function(t){a.buscar_oc=t},expression:"buscar_oc"}})],1),t("div",{staticClass:"col-12 text-center"},[t("b-button",{attrs:{disabled:""==a.buscar_oc,variant:"primary",size:"sm"},on:{click:function(t){return a.listarOrdenCompra()}}},[t("i",{staticClass:"fas fa-fw fa-search mr-2"}),a._v("BUSCAR")])],1)])]):t("div",{staticClass:"row justify-content-center mt-4"},[t("div",{staticClass:"col-12"},[t("b-card",[t("table",[t("td",[t("tr",[t("strong",{staticClass:"pr-3"},[a._v("Orden de compra")])]),t("tr",[t("strong",{staticClass:"pr-3"},[a._v("Fecha")])]),t("tr",[t("strong",{staticClass:"pr-3"},[a._v("Bodega")])]),t("tr",[t("strong",{staticClass:"pr-3"},[a._v("Glosa")])])]),t("td",[t("tr",[a._v(":"),t("span",{staticClass:"pl-3"},[a._v(a._s(a.nuevo_ingreso.oc))])]),t("tr",[a._v(":"),t("span",{staticClass:"pl-3"},[a._v(a._s(a.nuevo_ingreso.fecha))])]),t("tr",[a._v(":"),t("span",{staticClass:"pl-3"},[a._v(a._s(a.nuevo_ingreso.bodega))])]),t("tr",[a._v(":"),t("span",{staticClass:"pl-3"},[a._v(a._s(a.nuevo_ingreso.glosa))])])])]),""!=a.nuevo_ingreso.mensaje?t("h6",[t("strong",[a._v("Mensaje:")]),a._v(" "+a._s(a.nuevo_ingreso.mensaje))]):a._e(),t("b-table",{attrs:{striped:"",hover:"",items:a.nuevo_ingreso.articulos,fields:a.columnas_articulos,"thead-tr-class":"text-center align-middle bg-dark text-white"},scopedSlots:a._u([{key:"cell(codigo)",fn:function(t){return[a._v(" "+a._s(t.item.codigo+"-"+t.item.ver)+" ")]}},{key:"cell(saldo)",fn:function(e){return[t("span",{class:{"badge badge-success badge-pill":e.value<=0,"badge badge-warning badge-pill":e.value>0}},[a._v(a._s(e.value))])]}},{key:"cell(cant_recibida)",fn:function(e){return[t("b-form-input",{class:{"is-valid":a.validaNumero(e.item.cant_recibida)&&0!=e.item.cant_recibida,"is-invalid":!a.validaNumero(e.item.cant_recibida)&&0!=e.item.cant_recibida},attrs:{size:"sm",type:"text"},on:{change:function(t){return a.cambioCantidad()}},model:{value:e.item.cant_recibida,callback:function(t){a.$set(e.item,"cant_recibida",t)},expression:"data.item.cant_recibida"}})]}},{key:"cell(estantes_usar)",fn:function(e){return[t("b-form-input",{class:{"is-valid":a.validaNumero(e.item.estantes_usar)&&0!=e.item.estantes_usar&&0!=e.item.cant_recibida,"is-invalid":(!a.validaNumero(e.item.estantes_usar)||0==e.item.estantes_usar)&&0!=e.item.cant_recibida},attrs:{size:"sm",type:"text",disabled:!a.validaNumero(e.item.cant_recibida)||0==e.item.cant_recibida},on:{change:function(t){e.item.estantes=a.cambioEstantes(e.item.estantes,e.item.estantes_usar)}},model:{value:e.item.estantes_usar,callback:function(t){a.$set(e.item,"estantes_usar",t)},expression:"data.item.estantes_usar"}})]}},{key:"cell(estantes)",fn:function(e){return[t("div",{staticClass:"container-fluid",staticStyle:{"min-width":"300px!important"}},a._l(e.item.estantes,(function(s,i){return t("div",{key:"idx"+i,staticClass:"row p-0"},[t("div",{staticClass:"col-4 p-0"},[t("b-form-input",{class:{"is-valid":a.validaNumero(s.cantidad)&&0!=s.cantidad&&0!=e.item.cant_recibida,"is-invalid":(!a.validaNumero(s.cantidad)||0==s.cantidad||!a.validaCantidadRecibida(e.item))&&0!=e.item.cant_recibida},attrs:{size:"sm",type:"text",disabled:!a.validaNumero(e.item.cant_recibida)||0==e.item.cant_recibida},model:{value:s.cantidad,callback:function(t){a.$set(s,"cantidad",t)},expression:"estante.cantidad"}})],1),t("div",{staticClass:"col-8 p-0"},[t("v-select",{staticClass:"form-control form-control-sm p-0 h-auto",class:{"is-invalid":(0==s.estante||null==s.estante)&&a.validaNumero(e.item.cant_recibida)&&0!=e.item.cant_recibida,"is-valid":0!=s.estante&&null!=s.estante&&a.validaNumero(e.item.cant_recibida)&&0!=e.item.cant_recibida},staticStyle:{width:"100%!important"},attrs:{reduce:a=>a.esp_id,label:"esp_nombre",clearable:!0,closeOnSelect:!0,options:a.espacios_disponibles,disabled:!a.validaNumero(e.item.cant_recibida)||0==e.item.cant_recibida},scopedSlots:a._u([{key:"no-options",fn:function({search:e,searching:s}){return[s?[a._v(" SIN RESULTADOS PARA "),t("em",[a._v(a._s(e))]),a._v(". ")]:t("em",{staticStyle:{opacity:"0.5"}},[a._v("SIN OPCIONES PARA MOSTRAR.")])]}},{key:"option",fn:function(e){return[t("div",{class:{"disabled-option":!a.desactivaEstante(e)},attrs:{disabled:!a.desactivaEstante(e)}},[a._v(" "+a._s(e.esp_nombre)+" ")])]}}],null,!0),model:{value:s.estante,callback:function(t){a.$set(s,"estante",t)},expression:"estante.estante"}})],1)])})),0)]}},{key:"cell(certificacion)",fn:function(e){return[t("b-form-checkbox",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"text-center",attrs:{name:"check-button",switch:"",title:"Requiere certificación."},model:{value:e.item.certificacion,callback:function(t){a.$set(e.item,"certificacion",t)},expression:"data.item.certificacion"}})]}}])}),t("div",{staticClass:"row text-center"},[t("div",{staticClass:"col"},[t("b-button",{attrs:{size:"sm",variant:"danger"},on:{click:function(t){return a.limpiarIngreso()}}},[a._v("CANCELAR")])],1),t("div",{staticClass:"col"},[t("b-button",{attrs:{size:"sm",disabled:!a.validarIngreso(),variant:"success"},on:{click:function(t){a.modal_confirmar_oc=!0}}},[a._v("ACEPTAR")])],1)])],1)],1)]),t("b-modal",{attrs:{size:"lg",title:"CONFIRMAR","hide-footer":"","no-close-on-backdrop":""},model:{value:a.modal_confirmar_oc,callback:function(t){a.modal_confirmar_oc=t},expression:"modal_confirmar_oc"}},[a.ingresando_datos_extra?t("div",{staticClass:"w-100"},[t("h6",{staticClass:"mb-3 font-weight-bold text-center"},[a._v("* Campos obligatorios")]),t("h6",[t("strong",[a._v("*")]),a._v(" Fecha estimada de despacho:")]),t("b-form-datepicker",{staticClass:"mb-3",attrs:{size:"sm",min:a.fecha_actual,placeholder:"SELECCIONA FECHA","label-help":"Selecciona un día.","label-no-date-selected":"-","label-next-month":"SIGUIENTE MES","label-prev-month":"MES ANTERIOR","label-prev-year":"AÑO ANTERIOR","label-next-year":"SIGUIENTE AÑO","label-current-month":"MES ACTUAL","start-weekday":"1"},model:{value:a.nuevo_ingreso.fecha_estimada_despacho,callback:function(t){a.$set(a.nuevo_ingreso,"fecha_estimada_despacho",t)},expression:"nuevo_ingreso.fecha_estimada_despacho"}}),t("h6",[t("strong",[a._v("*")]),a._v(" Tipo documento asociado:")]),t("b-form-select",{staticClass:"mb-3",attrs:{size:"sm",options:a.tipos_documentos},model:{value:a.nuevo_ingreso.tipo_doc_asociado,callback:function(t){a.$set(a.nuevo_ingreso,"tipo_doc_asociado",t)},expression:"nuevo_ingreso.tipo_doc_asociado"}}),t("h6",[t("strong",[a._v("*")]),a._v(" Documento asociado:")]),t("b-form-input",{staticClass:"mb-3",attrs:{size:"sm"},model:{value:a.nuevo_ingreso.doc_asociado,callback:function(t){a.$set(a.nuevo_ingreso,"doc_asociado",t)},expression:"nuevo_ingreso.doc_asociado"}}),t("h6",[t("strong",[a._v("*")]),a._v(" Rut transportista:")]),t("b-form-input",{staticClass:"mb-3",class:{"is-valid":""!=a.nuevo_ingreso.rut_transportista&&a.verificarRut(a.nuevo_ingreso.rut_transportista),"is-invalid":""!=a.nuevo_ingreso.rut_transportista&&!a.verificarRut(a.nuevo_ingreso.rut_transportista)},attrs:{size:"sm"},on:{input:function(t){a.nuevo_ingreso.rut_transportista=a.formateaRut(a.nuevo_ingreso.rut_transportista)}},model:{value:a.nuevo_ingreso.rut_transportista,callback:function(t){a.$set(a.nuevo_ingreso,"rut_transportista",t)},expression:"nuevo_ingreso.rut_transportista"}}),t("h6",[a._v("Orden transporte:")]),t("b-form-input",{staticClass:"mb-3",attrs:{size:"sm"},model:{value:a.nuevo_ingreso.orden_transporte,callback:function(t){a.$set(a.nuevo_ingreso,"orden_transporte",t)},expression:"nuevo_ingreso.orden_transporte"}}),t("h6",[a._v("Fecha documento transporte:")]),t("b-form-datepicker",{staticClass:"mb-3",attrs:{size:"sm",placeholder:"SELECCIONA FECHA","label-help":"Selecciona un día.","label-no-date-selected":"-","label-next-month":"SIGUIENTE MES","label-prev-month":"MES ANTERIOR","label-prev-year":"AÑO ANTERIOR","label-next-year":"SIGUIENTE AÑO","label-current-month":"MES ACTUAL","start-weekday":"1"},model:{value:a.nuevo_ingreso.fecha_transporte,callback:function(t){a.$set(a.nuevo_ingreso,"fecha_transporte",t)},expression:"nuevo_ingreso.fecha_transporte"}}),t("h6",[a._v("Peso transporte(kg):")]),t("b-form-input",{staticClass:"mb-3",attrs:{size:"sm"},model:{value:a.nuevo_ingreso.peso_transporte,callback:function(t){a.$set(a.nuevo_ingreso,"peso_transporte",t)},expression:"nuevo_ingreso.peso_transporte"}}),t("h6",[a._v("Observación:")]),t("b-form-textarea",{attrs:{placeholder:"Ingresa texto...",rows:"3","max-rows":"6"},model:{value:a.nuevo_ingreso.observacion,callback:function(t){a.$set(a.nuevo_ingreso,"observacion",t)},expression:"nuevo_ingreso.observacion"}})],1):t("div",{staticClass:"w-100"},[t("div",{staticClass:"container-fluid mb-3 card p-3"},[t("h6",[t("strong",[a._v("Confirma los siguentes datos para el ingreso de bodega:")])]),t("ul",a._l(a.nuevo_ingreso.articulos,(function(e){return t("li",{directives:[{name:"show",rawName:"v-show",value:e.cant_recibida>0,expression:"articulo.cant_recibida > 0"}],key:e.codigo},[t("div",{staticClass:"row"},[t("div",{staticClass:"col-2"},[a._v(a._s(e.codigo+"-"+e.ver))]),t("div",{staticClass:"col-8 font-weight-bold"},[a._v(a._s(e.nomart))]),t("div",{staticClass:"col-2 text-right"},[t("span",{staticClass:"badge badge-dark badge-pill"},[t("strong",[a._v(a._s(e.cant_recibida+" "+e.umed))])])])]),t("div",{staticClass:"row"},[t("div",{staticClass:"col"},[t("ul",a._l(e.estantes,(function(s,i){return t("li",{key:"est"+i},[a._v(a._s(s.cantidad+" "+e.umed)+" en estante "),a._l(a.espacios_disponibles,(function(e){return e.esp_id==s.estante?t("span",{key:"esp"+e.esp_id,staticClass:"badge badge-primary badge-pill"},[a._v(a._s(e.esp_nombre))]):a._e()}))],2)})),0)])])])})),0)]),t("div",{staticClass:"container-fluid card p-3"},[t("div",{staticClass:"row"},[t("div",{staticClass:"col-5"},[t("h6",[a._v("Fecha estimada de despacho")])]),t("div",{staticClass:"col-7"},[t("h6",[a._v(": "+a._s(a.nuevo_ingreso.fecha_estimada_despacho.split("-")[2]+"-"+a.nuevo_ingreso.fecha_estimada_despacho.split("-")[1]+"-"+a.nuevo_ingreso.fecha_estimada_despacho.split("-")[0]))])]),""!=a.nuevo_ingreso.tipo_doc_asociado?t("div",{staticClass:"col-5"},[t("h6",[a._v("Tipo documento asociado")])]):a._e(),""!=a.nuevo_ingreso.tipo_doc_asociado?t("div",{staticClass:"col-7"},a._l(a.tipos_documentos,(function(e,s){return t("h6",{directives:[{name:"show",rawName:"v-show",value:e.value==a.nuevo_ingreso.tipo_doc_asociado,expression:"doc.value==nuevo_ingreso.tipo_doc_asociado"}],key:"tip"+s},[a._v(": "+a._s(e.text))])})),0):a._e(),""!=a.nuevo_ingreso.doc_asociado?t("div",{staticClass:"col-5"},[t("h6",[a._v("N° Documento asociado")])]):a._e(),""!=a.nuevo_ingreso.doc_asociado?t("div",{staticClass:"col-7"},[t("h6",[a._v(": "+a._s(a.nuevo_ingreso.doc_asociado))])]):a._e(),t("div",{staticClass:"col-5"},[t("h6",[a._v("Rut Transportista")])]),t("div",{staticClass:"col-7"},[t("h6",[a._v(": "+a._s(a.nuevo_ingreso.rut_transportista))])]),""!=a.nuevo_ingreso.orden_transporte?t("div",{staticClass:"col-5"},[t("h6",[a._v("Orden de transporte")])]):a._e(),""!=a.nuevo_ingreso.orden_transporte?t("div",{staticClass:"col-7"},[t("h6",[a._v(": "+a._s(a.nuevo_ingreso.orden_transporte))])]):a._e(),""!=a.nuevo_ingreso.fecha_transporte?t("div",{staticClass:"col-5"},[t("h6",[a._v("Fecha documento transporte")])]):a._e(),""!=a.nuevo_ingreso.fecha_transporte?t("div",{staticClass:"col-7"},[t("h6",[a._v(": "+a._s(a.nuevo_ingreso.fecha_transporte))])]):a._e(),""!=a.nuevo_ingreso.peso_transporte?t("div",{staticClass:"col-5"},[t("h6",[a._v("Peso transporte")])]):a._e(),""!=a.nuevo_ingreso.peso_transporte?t("div",{staticClass:"col-7"},[t("h6",[a._v(": "+a._s(a.nuevo_ingreso.peso_transporte)+" kg.")])]):a._e(),""!=a.nuevo_ingreso.observacion?t("div",{staticClass:"col-5"},[t("h6",[a._v("Observación")])]):a._e(),""!=a.nuevo_ingreso.observacion?t("div",{staticClass:"col-7"},[t("h6",[a._v(": "+a._s(a.nuevo_ingreso.observacion))])]):a._e()])]),a.muestra_alerta?t("b-alert",{staticClass:"text-center mt-3",attrs:{show:"",variant:"warning"}},[t("strong",[t("i",{staticClass:"fas fa-fw fa-exclamation-triangle mr-2"}),a._v(" "+a._s(a.msj_alerta))])]):a._e()],1),a.ingresando_datos_extra?t("div",{staticClass:"row mt-3 pt-3 border-top text-center"},[t("div",{staticClass:"col"},[t("b-button",{attrs:{size:"sm",variant:"danger"},on:{click:function(t){a.modal_confirmar_oc=!1,a.ingresando_datos_extra=!0}}},[a._v("CANCELAR")])],1),t("div",{staticClass:"col"},[t("b-button",{attrs:{disabled:!a.validaCamposObligatorios(),size:"sm",variant:"success"},on:{click:function(t){a.validarDocAsociado(),a.registro_iniciado=!1}}},[a._v("CONTINUAR")])],1)]):t("div",{staticClass:"row mt-3 pt-3 border-top text-center"},[t("div",{staticClass:"col"},[t("b-button",{attrs:{size:"sm",variant:"danger"},on:{click:function(t){a.modal_confirmar_oc=!1,a.ingresando_datos_extra=!0}}},[a._v("CANCELAR")])],1),t("div",{staticClass:"col"},[t("b-button",{attrs:{disabled:a.registro_iniciado,size:"sm",variant:"success"},on:{click:function(t){return a.registrarIngreso()}}},[a._v("CONFIRMAR")])],1)])]),t("b-modal",{attrs:{size:"lg",title:"REGISTRO DE INGRESO","hide-footer":"","no-close-on-backdrop":"",scrollable:!1},model:{value:a.modal_msj,callback:function(t){a.modal_msj=t},expression:"modal_msj"}},[t("div",{staticClass:"row"},[t("div",{staticClass:"col-12"},[t("h6",[t("strong",[a._v(a._s(a.msj_registro))])])])]),t("div",{staticClass:"row mt-3 pt-3 border-top"},[t("div",{staticClass:"col text-center"},[t("b-button",{attrs:{variant:"primary",size:"sm"},on:{click:function(t){return a.limpiarDatos()}}},[a._v("ACEPTAR")])],1)])]),t("b-modal",{attrs:{title:"Historial de ingresos",size:"xl","no-close-on-backdrop":"","content-class":"alto-modal"},scopedSlots:a._u([{key:"modal-footer",fn:function(){return[t("div",{staticClass:"text-center w-100"},[t("b-button",{attrs:{variant:"danger",size:"sm"},on:{click:function(t){a.modal_historial=!1}}},[a._v("Cerrar")])],1)]},proxy:!0}]),model:{value:a.modal_historial,callback:function(t){a.modal_historial=t},expression:"modal_historial"}},[t("b-card",{staticClass:"mb-2"},[t("div",{staticClass:"row pb-2 mb-2 border-bottom"},[t("div",{staticClass:"col-12"},[t("b-form-group",{attrs:{label:"Filtrar por:"}},[t("b-form-radio-group",{attrs:{id:"radio-group-1",options:a.tipos_filtro,name:"radio-options"},model:{value:a.tipo_filtro_historial,callback:function(t){a.tipo_filtro_historial=t},expression:"tipo_filtro_historial"}})],1)],1)]),1==a.tipo_filtro_historial?t("div",{staticClass:"row"},[t("div",{staticClass:"col-6"},[t("h6",[a._v("Desde")]),t("b-form-datepicker",{attrs:{size:"sm",placeholder:"SELECCIONA FECHA","label-help":"Selecciona un día.","label-no-date-selected":"-","label-next-month":"SIGUIENTE MES","label-prev-month":"MES ANTERIOR","label-prev-year":"AÑO ANTERIOR","label-next-year":"SIGUIENTE AÑO","label-current-month":"MES ACTUAL","start-weekday":"1"},model:{value:a.filtro_fecha_desde,callback:function(t){a.filtro_fecha_desde=t},expression:"filtro_fecha_desde"}})],1),t("div",{staticClass:"col-6"},[t("h6",[a._v("Hasta")]),t("b-form-datepicker",{attrs:{size:"sm",placeholder:"SELECCIONA FECHA","label-help":"Selecciona un día.","label-no-date-selected":"-","label-next-month":"SIGUIENTE MES","label-prev-month":"MES ANTERIOR","label-prev-year":"AÑO ANTERIOR","label-next-year":"SIGUIENTE AÑO","label-current-month":"MES ACTUAL","start-weekday":"1"},model:{value:a.filtro_fecha_hasta,callback:function(t){a.filtro_fecha_hasta=t},expression:"filtro_fecha_hasta"}})],1)]):a._e(),2==a.tipo_filtro_historial?t("div",{staticClass:"row justify-content-center"},[t("div",{staticClass:"col-6"},[t("h6",[a._v("Ingresa el N° del ingreso")]),t("b-form-input",{attrs:{size:"sm",placeholder:"nro ingreso"},model:{value:a.filtro_id_ingreso,callback:function(t){a.filtro_id_ingreso=t},expression:"filtro_id_ingreso"}})],1)]):a._e(),t("div",{staticClass:"row text-center"},[t("div",{staticClass:"col-12 mt-2"},[t("b-button",{attrs:{disabled:2==a.tipo_filtro_historial&&""==a.filtro_id_ingreso,variant:"success",size:"sm"},on:{click:function(t){return a.listarHistorialIngresos()}}},[t("i",{staticClass:"fas fa-fw fa-search mr-2"}),a._v("Filtrar")])],1)])]),t("div",[a.historial_ingresos.length>0?t("b-table",{attrs:{striped:"",hover:"",items:a.historial_ingresos,fields:a.columnas_historial,"thead-tr-class":"text-center align-middle bg-dark text-white"},scopedSlots:a._u([{key:"cell(ing_fecha_ingreso)",fn:function(t){return[a._v(" "+a._s(t.value.split(" ")[0].split("-")[2]+"/"+t.value.split(" ")[0].split("-")[1]+"/"+t.value.split(" ")[0].split("-")[0]+" "+t.value.split(" ")[1].split(":")[0]+":"+t.value.split(" ")[1].split(":")[1])+" ")]}},{key:"cell(ing_despacho_estimado)",fn:function(t){return[a._v(" "+a._s(t.value.split("-")[2]+"/"+t.value.split("-")[1]+"/"+t.value.split("-")[0])+" ")]}},{key:"cell(ing_rut_transportista)",fn:function(e){return[e.value&&e.item.ing_dv_transportista?t("span",[a._v(a._s(e.value+"-"+e.item.ing_dv_transportista))]):a._e()]}},{key:"cell(ing_documento_asociado)",fn:function(e){return a._l(a.tipos_documentos,(function(s){return s.value==e.item.ing_tipo_documento?t("span",[a._v(a._s(s.text+" "+e.value))]):a._e()}))}},{key:"cell(opcion)",fn:function(e){return[t("b-button",{attrs:{variant:"primary",size:"sm"},on:{click:function(t){return a.listarDetalleIngreso(e.item.ing_id)}}},[a._v("VER")])]}}],null,!1,462613234)}):t("b-alert",{staticClass:"text-center",attrs:{show:"",variant:"info"}},[a._v("Sin resultados.")])],1)],1),t("b-modal",{attrs:{title:"Detalle de ingreso",size:"lg"},scopedSlots:a._u([{key:"modal-footer",fn:function(){return[t("div",{staticClass:"text-center w-100"},[t("b-button",{attrs:{variant:"danger",size:"sm"},on:{click:function(t){a.modal_detalle_ingreso=!1}}},[a._v("Cerrar")])],1)]},proxy:!0}]),model:{value:a.modal_detalle_ingreso,callback:function(t){a.modal_detalle_ingreso=t},expression:"modal_detalle_ingreso"}},[""!=a.detalle_ingreso?t("div",{staticClass:"w-100"},[t("h6",[t("strong",[a._v("N° Ingreso:")]),a._v(" "+a._s(a.detalle_ingreso.ing_id))]),t("h6",[t("strong",[a._v("Fecha:")]),a._v(" "+a._s(a.detalle_ingreso.ing_fecha_ingreso.split(" ")[0].split("-")[2]+"/"+a.detalle_ingreso.ing_fecha_ingreso.split(" ")[0].split("-")[1]+"/"+a.detalle_ingreso.ing_fecha_ingreso.split(" ")[0].split("-")[0]+" "+a.detalle_ingreso.ing_fecha_ingreso.split(" ")[1].split(":")[0]+":"+a.detalle_ingreso.ing_fecha_ingreso.split(" ")[1].split(":")[1]))]),t("h6",[t("strong",[a._v("OC:")]),a._v(" "+a._s(a.detalle_ingreso.ing_orden_compra))]),t("h6",[t("strong",[a._v("Doc. Asociado:")]),a._v(" "),a._l(a.tipos_documentos,(function(e){return e.value==a.detalle_ingreso.ing_tipo_documento?t("span",[a._v(a._s(e.text+" "+a.detalle_ingreso.ing_documento))]):a._e()}))],2),t("h6",[t("strong",[a._v("Despacho estimado:")]),a._v(" "+a._s(a.detalle_ingreso.ing_despacho_estimado.split("-")[2]+"/"+a.detalle_ingreso.ing_despacho_estimado.split("-")[1]+"/"+a.detalle_ingreso.ing_despacho_estimado.split("-")[0]))]),t("h6",[t("strong",[a._v("Rut transportista:")]),a._v(" "+a._s(a.detalle_ingreso.ing_rut_transportista+"-"+a.detalle_ingreso.ing_dv_transportista))]),t("h6",[t("strong",[a._v("Peso de carga(kg):")]),a._v(" "+a._s(a.detalle_ingreso.ing_peso_transporte))]),t("h6",[t("strong",[a._v("Observación:")]),a._v(" "+a._s(a.detalle_ingreso.ing_observacion))])]):a._e(),t("b-table",{attrs:{striped:"",hover:"",items:a.detalle_ingreso.articulos,fields:a.columnas_detalle_ingreso,"thead-tr-class":"text-center align-middle bg-dark text-white"},scopedSlots:a._u([{key:"cell(ari_espacio)",fn:function(t){return[a._v(" "+a._s(t.item.esp_estante+"-"+t.item.esp_seccion+"-"+t.item.esp_numero)+" ")]}}])})],1)],1)},i=[function(){var a=this,t=a._self._c;return t("div",{staticClass:"col-xl-8 col-lg-8 col-md-8 col-sm-12 text-md-left text-center"},[t("h3",[t("i",{staticClass:"fas fa-fw fa-box mr-2"}),a._v("INGRESOS DE BODEGA")])])}],o={data(){return{cargando_pagina:!1,sucursales:[],tipos_documentos:[{value:33,text:"FACTURA"},{value:52,text:"GUIA DESPACHO"}],espacios_disponibles:[],esp_disp_filtrados:[],modal_msj:!1,msj_registro:"",filtro_estante:"",fecha_actual:"",columnas_articulos:[{key:"codigo",label:"Codigo",sortable:!1,tdClass:"p-1",thClass:"p-1"},{key:"nomart",label:"Articulo",sortable:!1,tdClass:"p-1",thClass:"p-1"},{key:"umed",label:"U. Medida",sortable:!1,tdClass:"p-1 text-center",thClass:"p-1"},{key:"cant",label:"Cantidad comprada",sortable:!1,tdClass:"p-1 text-center",thClass:"p-1"},{key:"saldo",label:"Saldo pendiente",sortable:!1,tdClass:"p-1 text-center",thClass:"p-1"},{key:"cant_recibida",label:"Cantidad recibida",sortable:!1,tdClass:"p-1",thClass:"p-1"},{key:"estantes_usar",label:"Estantes a usar",sortable:!1,tdClass:"p-1",thClass:"p-1"},{key:"estantes",label:"Cantidad x Estante",sortable:!1,tdClass:"p-1",thClass:"p-1"},{key:"certificacion",label:"Certificación",sortable:!1,tdClass:"p-1",thClass:"p-1"}],nuevo_ingreso:{bodega:"",fecha:"",glosa:"",mensaje:"",oc:"",articulos:[],fecha_estimada_despacho:"",doc_asociado:"",tipo_doc_asociado:"",rut_transportista:"",orden_transporte:"",fecha_transporte:"",peso_transporte:"",observacion:""},buscar_oc:"",modal_confirmar_oc:!1,ingresando_datos_extra:!0,muestra_alerta:!1,msj_alerta:"",formato_numero:/^[0-9]+([.][0-9]*)?$/,modal_historial:!1,modal_detalle_ingreso:!1,historial_ingresos:[],detalle_ingreso:"",filtro_fecha_desde:"",filtro_fecha_hasta:"",filtro_id_ingreso:"",tipos_filtro:[{text:"Fechas",value:1},{text:"N° Ingreso",value:2}],tipo_filtro_historial:1,registro_iniciado:!1,columnas_historial:[{key:"ing_id",label:"N° Ingreso",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"},{key:"ing_fecha_ingreso",label:"Fecha",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"},{key:"ing_orden_compra",label:"OC",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"},{key:"ing_documento",label:"Doc. Asoc.",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"},{key:"ing_despacho_estimado",label:"Desp. Estimado",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"},{key:"ing_rut_transportista",label:"Rut Transportista",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"},{key:"ing_peso_transporte",label:"Peso carga",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"},{key:"opcion",label:"-",tdClass:"p-1 text-center",thClass:"p-1"}],columnas_detalle_ingreso:[{key:"ari_codigo",label:"SKU",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"},{key:"ari_nombre",label:"Nombre",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"},{key:"ari_unidad_medida",label:"U. Medida",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"},{key:"ari_cantidad",label:"Cantidad",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"},{key:"ari_sucursal_destino",label:"Bod. Destino",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"},{key:"ari_espacio",label:"Estante",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"}]}},mounted(){this.fecha_actual=new Date,this.listarSucursales(),this.listarEspaciosDisponibles(),this.filtro_fecha_hasta=new Date,this.filtro_fecha_desde=new Date(this.filtro_fecha_hasta.getTime()-2592e6),this.filtro_fecha_desde=this.filtro_fecha_desde.getFullYear()+"-"+(this.filtro_fecha_desde.getMonth()+1)+"-"+this.filtro_fecha_desde.getDate(),this.filtro_fecha_hasta=this.filtro_fecha_hasta.getFullYear()+"-"+(this.filtro_fecha_hasta.getMonth()+1)+"-"+this.filtro_fecha_hasta.getDate()},methods:{listarOrdenCompra(){if(""==this.buscar_oc)return;this.cargando_pagina=!0;const a=new URLSearchParams;a.append("orden_compra",this.buscar_oc),axios.post(base_url+"bodega/listarOrdenCompra",a).then(a=>{200==a.data.status?200==a.data.data.Cod?(this.nuevo_ingreso.oc=a.data.data.ocompra,this.nuevo_ingreso.bodega=a.data.data.bod,this.nuevo_ingreso.fecha=a.data.data.fecha,this.nuevo_ingreso.glosa=a.data.data.glosa,this.nuevo_ingreso.mensaje=a.data.data.mensaje,this.nuevo_ingreso.articulos=a.data.data.codigos):alert("Orden de compra no encontrada."):alert("Falló la conexion con CGI interno."),this.cargando_pagina=!1}).catch(a=>{this.cargando_pagina=!1})},limpiarIngreso(){this.buscar_oc="",this.nuevo_ingreso={bodega:"",fecha:"",glosa:"",mensaje:"",oc:"",articulos:[],fecha_estimada_despacho:"",doc_asociado:"",tipo_doc_asociado:"",rut_transportista:"",orden_transporte:"",fecha_transporte:"",peso_transporte:"",observacion:""}},validaCamposObligatorios(){return!(""==this.nuevo_ingreso.fecha_estimada_despacho||""==this.nuevo_ingreso.tipo_doc_asociado||""==this.nuevo_ingreso.doc_asociado||!this.verificarRut(this.nuevo_ingreso.rut_transportista))},validarIngreso(){let a=!0,t=!1;return this.nuevo_ingreso.articulos.forEach(e=>{this.validaNumero(e.cant_recibida)&&(!this.validaNumero(e.cant_recibida)||0==e.cant_recibida||0!=e.estantes_usar&&""!=e.estantes_usar&&null!=e.estantes_usar)||(a=!1),this.validaNumero(e.cant_recibida)&&0!=e.cant_recibida&&e.estantes.forEach(t=>{(!this.validaNumero(t.cantidad)||this.validaNumero(t.cantidad)&&0!=t.cantidad&&t.cantidad>e.cant_recibida||""==t.estante||null==t.estante||0==t.estante)&&(a=!1)}),this.validaNumero(e.cant_recibida)&&0!=e.cant_recibida&&(t=!0)}),a&&t},validaCantidadRecibida(a){var t=0;return a.estantes.forEach(a=>{t+=parseFloat(a.cantidad)}),t==parseFloat(a.cant_recibida)},cambioCantidad(){this.nuevo_ingreso.articulos.forEach(a=>{0==a.cant_recibida&&(a.estantes_usar=0,a.estantes=[{cantidad:0,estante:0}])})},cambioEstantes(a,t){if(a=[],t>0)for(var e=0;e<t;e++)a.push({cantidad:0,estante:0});else a.push({cantidad:0,estante:0});return a},validaNumero(a){return!!this.formato_numero.test(a)},listarEspaciosDisponibles(){this.cargando_pagina=!0;const a=new URLSearchParams;a.append("peso",this.nuevo_ingreso.peso),axios.post(base_url+"bodega/listarEspaciosDisponibles",a).then(a=>{this.espacios_disponibles=a.data,this.filtrarEstantes(),this.cargando_pagina=!1}).catch(a=>{alert("Error al listar espacios disponibles."),console.log(a),this.cargando_pagina=!1})},filtrarEstantes(){""!=this.filtro_estante?(this.esp_disp_filtrados=[],this.espacios_disponibles.forEach(a=>{a.esp_estante==this.filtro_estante&&this.esp_disp_filtrados.push(a)})):this.esp_disp_filtrados=JSON.parse(JSON.stringify(this.espacios_disponibles))},listarSucursales(){this.cargando_pagina=!0,axios.post(base_url+"bodega/listarSucursales").then(a=>{this.sucursales=a.data,this.cargando_pagina=!1}).catch(a=>{alert("Error al listar sucursales."),console.log(a),this.cargando_pagina=!1})},validarDocAsociado(){const a=new URLSearchParams;a.append("doc",this.nuevo_ingreso.doc_asociado),a.append("tipo",this.nuevo_ingreso.tipo_doc_asociado),axios.post(base_url+"bodega/validarDocAsociado",a).then(a=>{2==a.data.key?(this.muestra_alerta=!0,this.msj_alerta="Este documento de proveedor asociado ya fue digitado anteriormente."):this.muestra_alerta=!1,this.ingresando_datos_extra=!1,this.cargando_pagina=!1}).catch(a=>{alert("Error al validar el doc asociado."),console.log(a),this.cargando_pagina=!1})},registrarIngreso(){this.cargando_pagina=!0;let a=JSON.parse(JSON.stringify(this.nuevo_ingreso));const t=a.rut_transportista.replace(/\./g,"").replace(/[^k|K|\d]/g,"").replace(/\-/g,"").trim().toUpperCase(),e=t.substr(-1,1),s=t.substr(0,t.length-1);a.rut_transportista=s,a.dv_transportista=e;const i=new URLSearchParams;i.append("ingreso",JSON.stringify(a)),axios.post(base_url+"bodega/registrarIngreso",i).then(a=>{1==a.data.key?(alert("Ingreso registrado correctamente."),this.limpiarIngreso(),this.modal_confirmar_oc=!1):alert(a.data.msj),this.cargando_pagina=!1}).catch(a=>{console.log(a),alert("Error al registrar ingreso."),this.cargando_pagina=!1})},listarHistorialIngresos(){this.cargando_pagina=!0;const a=new URLSearchParams;a.append("tipo_filtro",this.tipo_filtro_historial),a.append("fecha_desde",this.filtro_fecha_desde),a.append("fecha_hasta",this.filtro_fecha_hasta),a.append("id_ingreso",this.filtro_id_ingreso),a.append("orden_traspaso",this.filtro_orden_traspaso),axios.post(base_url+"bodega/listarHistorialIngresos",a).then(a=>{this.historial_ingresos=a.data,this.cargando_pagina=!1}).catch(a=>{console.log(a),alert("Error al listar historial de ingresos."),this.cargando_pagina=!1})},listarDetalleIngreso(a){this.cargando_pagina=!0;const t=new URLSearchParams;t.append("id_ingreso",a),axios.post(base_url+"bodega/listarDetalleIngreso",t).then(a=>{this.detalle_ingreso=a.data,this.modal_detalle_ingreso=!0,this.cargando_pagina=!1}).catch(a=>{console.log(a),alert("Error al listar detalle historial de ingresos."),this.cargando_pagina=!1})},desactivaEstante(a){let t=!0;return this.nuevo_ingreso.articulos.forEach(e=>{e.estantes.forEach(e=>{e.estante==a.esp_id&&(t=!1)})}),t},limpiarDatos(){this.nuevo_ingreso={documento:"",tipo_documento:"",orden_compra:"",sucursal:"",fecha_despacho:"",peso:"",espacio:""},this.espacios_disponibles=[],this.modal_msj=!1},formateaRut(a){const t=a.replace(/\./g,"").replace(/[^k|K|\d]/g,"").replace(/\-/g,"").trim().toUpperCase(),e=t.substr(-1,1),s=t.substr(0,t.length-1);let i="";var o=0,r=1;for(o=s.length-1;o>=0;o--){const a=s.charAt(o);i=a.concat(i),r%3==0&&r<=s.length-1&&(i=".".concat(i)),r++}var l="";return l=i.length>0?i.concat("-").concat(e):e,l},verificarRut(a){let t=!1;if(null!=a&&a.toString().length>=11&&a.toString().length<14){let e=a.substring(a.length-1,a.length);if(a=a.replace(/[.|-]/g,"").slice(0,-1),-1==a.indexOf("K")){let s=0,i=1;for(;a;a=Math.floor(a/10))i=(i+a%10*(9-s++%6))%11;let o=(i?i-1:"K").toString();o===e&&(t=!0)}}return t}}},r=o,l=(e("364e"),e("2877")),n=Object(l["a"])(r,s,i,!1,null,null,null);t["default"]=n.exports},"9ba8":function(a,t,e){},"9f260":function(a,t,e){"use strict";e.r(t);var s=function(){var a=this,t=a._self._c;return t("div",{staticClass:"container-fluid"},[t("loader-component",{attrs:{cargando_pagina:a.cargando_pagina}}),a._m(0),a.muestra_nueva_valorizacion||a.muestra_ver_valorizacion?a._e():t("b-card",{staticClass:"mt-4"},[t("h5",{staticClass:"mb-3"},[a._v("Nueva valorización")]),t("h6",[a._v("Ingresa orden de compra:")]),t("div",{staticClass:"row justify-content-center"},[t("div",{staticClass:"col-xl-10 col-md-8 col-12"},[t("b-form-input",{staticClass:"mb-3",attrs:{size:"sm"},on:{keyup:function(t){return!t.type.indexOf("key")&&a._k(t.keyCode,"enter",13,t.key,"Enter")?null:a.listarOrdenCompra()}},model:{value:a.buscar_oc,callback:function(t){a.buscar_oc=t},expression:"buscar_oc"}})],1),t("div",{staticClass:"col-xl-2 col-md-4 col-12 text-center"},[t("b-button",{attrs:{disabled:""==a.buscar_oc,variant:"primary",size:"sm",block:""},on:{click:function(t){return a.listarOrdenCompra()}}},[t("i",{staticClass:"fas fa-fw fa-search mr-2"}),a._v("BUSCAR")])],1)])]),a.muestra_nueva_valorizacion?t("nueva-valorizacion-component",{attrs:{orden_compra_p:a.orden_compra},on:{cerrar:function(t){a.muestra_nueva_valorizacion=!1}}}):a._e(),a.muestra_ver_valorizacion?t("ver-valorizacion-component",{attrs:{val_id_p:a.val_id_p},on:{cerrar:function(t){a.muestra_ver_valorizacion=!1}}}):a._e(),!a.muestra_lista_valorizaciones||a.muestra_nueva_valorizacion||a.muestra_ver_valorizacion?a._e():t("lista-valorizaciones-component",{on:{ver_val:function(t){a.muestra_ver_valorizacion=!0,a.val_id_p=t}}})],1)},i=[function(){var a=this,t=a._self._c;return t("div",{staticClass:"row"},[t("div",{staticClass:"col-xl-8 col-lg-8 col-md-8 col-sm-12 text-md-left text-center"},[t("h3",[t("i",{staticClass:"fas fa-fw fa-dollar-sign mr-2"}),a._v("VALORIZACIÓN")])])])}],o={data(){return{cargando_pagina:!1,muestra_nueva_valorizacion:!1,muestra_lista_valorizaciones:!0,muestra_ver_valorizacion:!1,val_id_p:0,orden_compra:{bodega:"",fecha:"",glosa:"",mensaje:"",oc:"",articulos:[]},buscar_oc:"1178904"}},mounted(){},methods:{listarOrdenCompra(){if(""==this.buscar_oc)return;this.cargando_pagina=!0;const a=new URLSearchParams;a.append("orden_compra",this.buscar_oc),axios.post(base_url+"valorizacion/listarOrdenCompra",a).then(a=>{1==a.data.key?200==a.data.status?200==a.data.data.Cod?(this.orden_compra.oc=a.data.data.ocompra,this.orden_compra.bodega=a.data.data.bod,this.orden_compra.fecha=a.data.data.fecha,this.orden_compra.glosa=a.data.data.glosa,this.orden_compra.mensaje=a.data.data.mensaje,this.orden_compra.articulos=a.data.data.codigos,this.orden_compra.articulos.forEach(a=>{a.valorextra=0,a.totalextra=0,a.totalpesos=0,a.valorpesos=0}),this.muestra_nueva_valorizacion=!0):alert("Orden de compra no encontrada."):alert("Falló la conexion con CGI interno."):alert(a.data.msj),this.cargando_pagina=!1}).catch(a=>{this.cargando_pagina=!1})}}},r=o,l=(e("cdf6"),e("2877")),n=Object(l["a"])(r,s,i,!1,null,null,null);t["default"]=n.exports},a1ff:function(a,t,e){a.exports=e.p+"img/huella4.0f3d9bd6.png"},be69:function(a,t,e){"use strict";e.r(t);var s=function(){var a=this,t=a._self._c;return t("div",{staticClass:"pagina"},[t("loader-component",{attrs:{cargando_pagina:a.cargando_pagina}}),t("biometria-component",{attrs:{modal_verificar_huella:a.modal_verificar_huella},on:{verificacion_correcta:a.verificacionCorrrecta,cerrar_modal_biometria:function(t){a.modal_verificar_huella=!1}}}),t("div",{staticClass:"container-fluid p-1 pagina2"},[a._m(0),t("div",{staticClass:"row"},[t("div",{staticClass:"col-12 text-md-left text-center"},[t("b-card",{staticStyle:{display:"flex"}},[t("h6",[t("strong",[a._v("CAPACIDADES:")])]),t("div",{staticClass:"mr-3",staticStyle:{float:"left"}},[a._v("DISPONIBLES:")]),t("div",{staticStyle:{float:"left"}},[t("b-card",{staticClass:"text-center alert-primary",staticStyle:{width:"100px","border-radius":"0!important"},attrs:{"no-body":""}},[a._v("2.000 Kg")])],1),t("div",{staticClass:"ml-3",staticStyle:{float:"left"}},[t("b-card",{staticClass:"text-center alert-warning",staticStyle:{width:"100px","border-radius":"0!important"},attrs:{"no-body":""}},[a._v("1.200 Kg")])],1),t("div",{staticClass:"ml-3",staticStyle:{float:"left"}},[t("b-card",{staticClass:"text-center alert-info",staticStyle:{width:"100px","border-radius":"0!important"},attrs:{"no-body":""}},[a._v("200 Kg")])],1),t("div",{staticClass:"ml-5 mr-3",staticStyle:{float:"left"}},[a._v("OCUPADOS:")]),t("div",{staticStyle:{float:"left"}},[t("b-card",{staticClass:"text-center alert-primary text-danger border-danger espacio_ocupado",staticStyle:{width:"100px","border-radius":"0!important"},attrs:{"no-body":""}},[a._v("2.000 Kg")])],1),t("div",{staticClass:"ml-3",staticStyle:{float:"left"}},[t("b-card",{staticClass:"text-center alert-warning text-danger border-danger espacio_ocupado",staticStyle:{width:"100px","border-radius":"0!important"},attrs:{"no-body":""}},[a._v("1.200 Kg")])],1),t("div",{staticClass:"ml-3",staticStyle:{float:"left"}},[t("b-card",{staticClass:"text-center alert-info text-danger border-danger espacio_ocupado",staticStyle:{width:"100px","border-radius":"0!important"},attrs:{"no-body":""}},[a._v("200 Kg")])],1)])],1)]),t("div",{staticClass:"row justify-content-between mt-2 pt-2 pb-2 bg-secondary"},a._l(a.estantes,(function(e,s){return t("div",{key:"est"+s,class:{"col-12":21==e.est_capacidad,"col-12 pr-5":17==e.est_id||19==e.est_id||e.est_id>19,"col-6":e.est_capacidad<10}},[t("b-card",{staticClass:"p-0 text-center",class:{"w-25":3==e.est_capacidad,"ml-auto":7==e.est_id||4==e.est_id,"w-50":17==e.est_id||19==e.est_id||e.est_id>19},attrs:{"no-body":"","header-class":"p-1"},scopedSlots:a._u([{key:"header",fn:function(){return[t("strong",[e.est_id<20?t("span",[a._v("ESTANTE")]):t("span",[a._v("ESPACIO EN SUELO")]),a._v(" "+a._s(e.est_id))])]},proxy:!0}],null,!0)},[t("div",{staticClass:"container-fluid"},[t("div",{staticClass:"row p-1 justify-content-betwen"},a._l(e.secciones,(function(s,i){return t("div",{key:"sec"+i,staticClass:"col p-0"},[t("b-card",{staticClass:"p-1",attrs:{"no-body":""}},[a._v(" Sec. "+a._s(s.sec_id)+" "),a._l(s.espacios,(function(i,o){return t("b-card",{key:"esp"+o,staticClass:"p-0 espacio",class:{"alert-dark":1e4==i.esp_peso,"alert-primary":2e3==i.esp_peso,"alert-warning":1200==i.esp_peso,"alert-info":200==i.esp_peso,"text-danger border-danger espacio_ocupado":i.esp_ocupado},attrs:{"no-body":""},on:{click:function(t){a.modal_detalle=!0,a.espacio_seleccionado=i,a.listarArticulosEspacio(i.esp_id),a.listarHistorialEspacio(i.esp_id)}}},[i.esp_ocupado?t("strong",{},[a._v(a._s(e.est_id)+"-"+a._s(s.sec_id)+"-"+a._s(i.esp_numero))]):t("span",[a._v(a._s(e.est_id)+"-"+a._s(s.sec_id)+"-"+a._s(i.esp_numero))])])}))],2)],1)})),0)])])],1)})),0),t("b-modal",{attrs:{size:"xl",title:"DETALLES DE RACK","hide-footer":"","no-close-on-backdrop":"",scrollable:!1},model:{value:a.modal_detalle,callback:function(t){a.modal_detalle=t},expression:"modal_detalle"}},[t("h5",[t("strong",[a._v("Información:")])]),t("div",{staticClass:"card alert-warning p-2"},[a.espacio_seleccionado?t("div",{staticClass:"container-fluid"},[t("div",{staticClass:"row text-center pb-1"},[t("div",{staticClass:"col font-weight-bold"},[t("span",{staticClass:"badge badge-primary badge-pill"},[a._v("Estante: "+a._s(a.espacio_seleccionado.esp_estante))])]),t("div",{staticClass:"col font-weight-bold"},[t("span",{staticClass:"badge badge-primary badge-pill"},[a._v("Sección: "+a._s(a.espacio_seleccionado.esp_seccion))])]),t("div",{staticClass:"col font-weight-bold border-right"},[t("span",{staticClass:"badge badge-primary badge-pill"},[a._v("Numero: "+a._s(a.espacio_seleccionado.esp_numero))])]),t("div",{staticClass:"col font-weight-bold"},[t("span",{staticClass:"badge badge-warning badge-pill"},[a._v("Ancho: "+a._s(a.espacio_seleccionado.esp_ancho)+" cm")])]),t("div",{staticClass:"col font-weight-bold"},[t("span",{staticClass:"badge badge-warning badge-pill"},[a._v("Alto: "+a._s(a.espacio_seleccionado.esp_alto)+" cm")])]),t("div",{staticClass:"col font-weight-bold"},[t("span",{staticClass:"badge badge-warning badge-pill"},[a._v("Fondo: "+a._s(a.espacio_seleccionado.esp_fondo)+" cm")])]),t("div",{staticClass:"col font-weight-bold"},[t("span",{staticClass:"badge badge-warning badge-pill"},[a._v("Peso max: "+a._s(a.espacio_seleccionado.esp_peso)+" kg")])])])]):a._e()]),t("h5",{staticClass:"mt-4"},[t("strong",[a._v("Ocupación actual:")])]),t("div",{staticClass:"w-100 text-center"},[a.cargando_articulos_espacio?t("b-spinner",{staticStyle:{width:"3rem",height:"3rem"},attrs:{variant:"primary",label:"Cargando"}}):a._e()],1),0!=a.articulos_espacio.length||a.cargando_articulos_espacio?a._e():t("b-alert",{attrs:{variant:"success",show:""}},[a._v("Sin articulos.")]),a._l(a.articulos_espacio,(function(e){return a.cargando_articulos_espacio?a._e():t("div",{key:e.ari_id,staticClass:"card alert-info p-2"},[t("div",{staticClass:"container-fluid"},[t("div",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"collapse-"+e.ari_id,expression:"'collapse-'+articulo.ari_id"}],staticClass:"row",staticStyle:{cursor:"pointer"}},[t("div",{staticClass:"col-9 font-weight-bold"},[a._v(a._s(e.ari_codigo+"-"+e.ari_ver+" | "+e.ari_nombre))]),t("div",{staticClass:"col-3 text-right"},[t("span",{staticClass:"badge badge-primary badge-pill mr-2"},[a._v(a._s(e.ari_cantidad+" "+e.ari_unidad_medida))]),0==e.ari_certificado?t("i",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"text-danger fas fa-medal fa-fw",attrs:{title:"Pendiente de certificación."}}):a._e(),1==e.ari_certificado?t("i",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"text-success fas fa-medal fa-fw",attrs:{title:"Certificado."}}):a._e()])]),t("b-collapse",{attrs:{id:"collapse-"+e.ari_id}},[t("div",{staticClass:"row mt-2 pt-2 pb-2 border-top border-bottom border-dark"},[t("div",{staticClass:"col-4"},[a._v("Numero Ingreso: "+a._s(e.ing_id))]),t("div",{staticClass:"col-4"},[a._v("Orden de compra: "+a._s(e.ing_orden_compra))]),e.ing_documento?t("div",{staticClass:"col-4"},[a._v("Doc. asociado: "),a._l(a.tipos_documentos,(function(s){return t("span",{directives:[{name:"show",rawName:"v-show",value:e.ing_tipo_documento==s.value,expression:"articulo.ing_tipo_documento==tipo.value"}],key:"tip"+s.value,staticClass:"text-lowercase"},[a._v(a._s(s.text))])})),a._v(" "+a._s(e.ing_documento))],2):a._e(),t("div",{staticClass:"col-4"},[a._v("Fecha Ingreso: "+a._s(e.ing_fecha_ingreso.split(" ")[0].split("-")[2]+"/"+e.ing_fecha_ingreso.split(" ")[0].split("-")[1]+"/"+e.ing_fecha_ingreso.split(" ")[0].split("-")[0]+" "+e.ing_fecha_ingreso.split(" ")[1].split(":")[0]+":"+e.ing_fecha_ingreso.split(" ")[1].split(":")[1]))]),t("div",{staticClass:"col-4"},[a._v("Despacho estimado: "+a._s(e.ing_despacho_estimado.split(" ")[0].split("-")[2]+"/"+e.ing_despacho_estimado.split(" ")[0].split("-")[1]+"/"+e.ing_despacho_estimado.split(" ")[0].split("-")[0]))]),e.ing_rut_transportista?t("div",{staticClass:"col-4"},[a._v("Rut transportista: "+a._s(e.ing_rut_transportista+"-"+e.ing_dv_transportista))]):a._e(),e.ing_orden_transporte?t("div",{staticClass:"col-4"},[a._v("Peso transporte: "+a._s(e.ing_orden_transporte))]):a._e(),e.ing_peso_transporte?t("div",{staticClass:"col-4"},[a._v("Peso transporte: "+a._s(e.ing_peso_transporte)+"Kg.")]):a._e(),e.ing_observacion?t("div",{staticClass:"col-12"},[a._v("Observacion: "+a._s(e.ing_observacion))]):a._e()]),null!=e.ari_certificado?t("div",{staticClass:"row mt-2"},[t("div",{staticClass:"col-12"},[t("h5",[t("strong",[a._v("Certificación:")])]),1==e.ari_certificado?t("p",[a._v(" Articulo certificado. "),t("i",{staticClass:"text-success fas fa-medal fa-fw ml-2"})]):a._e(),0==e.ari_certificado?t("p",[a._v(" Articulo pendiente de certificar. "),t("i",{staticClass:"text-danger fas fa-medal fa-fw ml-2"})]):a._e()]),1==e.ari_certificado?t("div",{staticClass:"col-12"},[t("h6",[t("strong",[a._v("Fecha registro:")]),a._v(" "+a._s(e.crt_fecha_hora.split(" ")[0].split("-")[2]+"-"+e.crt_fecha_hora.split(" ")[0].split("-")[1]+"-"+e.crt_fecha_hora.split(" ")[0].split("-")[0]+" "+e.crt_fecha_hora.split(" ")[1]))]),t("h6",[t("strong",[a._v("Usuario:")]),a._v(" "+a._s(e.crt_usuario))])]):a._e(),t("div",{staticClass:"col-12 text-center"},[0==e.ari_certificado?t("b-button",{attrs:{size:"sm",variant:"success"},on:{click:function(t){return a.muetraModalCertificado(e)}}},[a._v("CERTIFICAR")]):a._e(),1==e.ari_certificado?t("b-button",{attrs:{size:"sm",variant:"outline-primary"},on:{click:function(t){a.pdf_certificado=e.crt_archivo,a.modal_pdf=!0}}},[a._v("VER CERTIFICADO")]):a._e()],1)]):a._e()])],1)])})),t("h5",{staticClass:"mt-4"},[t("strong",[a._v("Historial:")])]),t("div",{staticClass:"w-100 text-center"},[a.cargando_historial_espacio?t("b-spinner",{staticStyle:{width:"3rem",height:"3rem"},attrs:{variant:"primary",label:"Cargando"}}):a._e()],1),0!=a.historial_espacio.length||a.cargando_historial_espacio?a._e():t("b-alert",{attrs:{variant:"dark",show:""}},[a._v("Sin articulos.")]),a._l(a.historial_espacio,(function(e){return a.cargando_historial_espacio?a._e():t("div",{key:e.ari_id,staticClass:"card alert-dark p-2"},[t("div",{staticClass:"container-fluid"},[t("div",{staticClass:"row border-bottom pb-2 mb-2"},[t("div",{staticClass:"col-10 font-weight-bold"},[a._v(a._s(e.ari_codigo+"-"+e.ari_ver+" | "+e.ari_nombre))]),t("div",{staticClass:"col-2 text-right"},[t("span",{staticClass:"badge badge-primary badge-pill"},[a._v(a._s(e.ars_cantidad+" "+e.ari_unidad_medida))])])]),t("div",{staticClass:"row"},[t("div",{staticClass:"col-4"},[a._v("Orden de compra: "+a._s(e.ing_orden_compra))]),t("div",{staticClass:"col-4"},[a._v("Doc. asociado: "),a._l(a.tipos_documentos,(function(s){return t("span",{directives:[{name:"show",rawName:"v-show",value:e.ing_tipo_documento==s.value,expression:"articulo.ing_tipo_documento==tipo.value"}],key:"tip"+s.value,staticClass:"text-lowercase"},[a._v(a._s(s.text))])})),a._v(" "+a._s(e.ing_documento))],2),t("div",{staticClass:"col-4"},[a._v("Destino: Bodega "+a._s(e.sld_bodega_destino))]),t("div",{staticClass:"col-4"},[a._v("Ingreso: "+a._s(e.ing_fecha_ingreso.split(" ")[0].split("-")[2]+"/"+e.ing_fecha_ingreso.split(" ")[0].split("-")[1]+"/"+e.ing_fecha_ingreso.split(" ")[0].split("-")[0]+" "+e.ing_fecha_ingreso.split(" ")[1].split(":")[0]+":"+e.ing_fecha_ingreso.split(" ")[1].split(":")[1]))]),t("div",{staticClass:"col-4"},[a._v("Salida: "+a._s(e.sld_fecha_salida.split(" ")[0].split("-")[2]+"/"+e.sld_fecha_salida.split(" ")[0].split("-")[1]+"/"+e.sld_fecha_salida.split(" ")[0].split("-")[0]+" "+e.sld_fecha_salida.split(" ")[1].split(":")[0]+":"+e.sld_fecha_salida.split(" ")[1].split(":")[1]))])])])])})),t("div",{staticClass:"row mt-3 pt-3 border-top"},[t("div",{staticClass:"col text-center"},[t("b-button",{attrs:{variant:"primary",size:"sm"},on:{click:function(t){a.modal_detalle=!1}}},[a._v("CERRAR")])],1)])],2),t("b-modal",{attrs:{title:"Certificar articulo",size:"lg",centered:"","hide-footer":"","no-close-on-backdrop":""},model:{value:a.modal_certificado,callback:function(t){a.modal_certificado=t},expression:"modal_certificado"}},[t("h6",[a._v("Adjunte el archivo correspondiente al certificado:")]),t("b-form-file",{attrs:{size:"sm",placeholder:"Subir archivo",multiple:"false",accept:".pdf","browse-text":"CERTIFICADO"},model:{value:a.archivo_certificado,callback:function(t){a.archivo_certificado=t},expression:"archivo_certificado"}}),t("p",{staticClass:"text-danger"},[a._v("Solo se permiten documentos en formato PDF")]),t("div",{staticClass:"row mt-5"},[t("div",{staticClass:"col-12 text-center"},[t("b-button",{staticClass:"mr-2",attrs:{size:"sm",variant:"danger"},on:{click:function(t){a.modal_certificado=!1,a.archivo_certificado=""}}},[a._v("CANCELAR")]),t("b-button",{attrs:{size:"sm",variant:"success",disabled:""==a.archivo_certificado},on:{click:function(t){a.modal_verificar_huella=!0}}},[a._v("CERTIFICAR")])],1)])],1),t("b-modal",{attrs:{title:"Certificado",size:"lg",centered:"","hide-footer":"","no-close-on-backdrop":""},model:{value:a.modal_pdf,callback:function(t){a.modal_pdf=t},expression:"modal_pdf"}},[a.modal_pdf?t("iframe",{attrs:{src:a.pdf_certificado,width:"100%",height:"600px"}}):a._e()])],1)],1)},i=[function(){var a=this,t=a._self._c;return t("div",{staticClass:"row"},[t("div",{staticClass:"col-12 text-md-left text-center"},[t("h3",[t("i",{staticClass:"fas fa-fw fa-warehouse mr-2"}),a._v("ESTADO DE BODEGA")])])])}],o={data(){return{meses:[{value:1,text:"ENERO"},{value:2,text:"FEBRERO"},{value:3,text:"MARZO"},{value:4,text:"ABRIL"},{value:5,text:"MAYO"},{value:6,text:"JUNIO"},{value:7,text:"JULIO"},{value:8,text:"AGOSTO"},{value:9,text:"SEPTIEMBRE"},{value:10,text:"OCTUBRE"},{value:11,text:"NOVIEMBRE"},{value:12,text:"DICIEMBRE"}],modal_detalle:!1,cargando_pagina:!1,cargando_articulos_espacio:!1,cargando_historial_espacio:!1,estantes:[],articulos_espacio:[],historial_espacio:[],espacio_seleccionado:null,columnas_articulos:[{key:"art_codigo",label:"SKU",sortable:!0,tdClass:"p-1",thClass:"p-1"},{key:"art_nombre",label:"Nombre",sortable:!0,tdClass:"p-1",thClass:"p-1"},{key:"art_cantidad",label:"Cantidad",sortable:!0,tdClass:"p-1",thClass:"p-1"},{key:"art_unidad_medida",label:"U. Medida",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"},{key:"art_orden_compra",label:"OC",sortable:!0,tdClass:"p-1 text-center",thClass:"p-1"},{key:"art_sucursal",label:"Sucursal destino",sortable:!0,tdClass:"p-1",thClass:"p-1"},{key:"art_documento",label:"Documento",sortable:!0,tdClass:"p-1",thClass:"p-1"},{key:"art_tipo_documento",label:"Tipo Doc.",sortable:!0,tdClass:"p-1",thClass:"p-1"},{key:"art_fecha_ingreso",label:"Fecha ingreso",sortable:!0,tdClass:"p-1",thClass:"p-1"},{key:"art_despacho_estimado",label:"Despacho estimado",sortable:!0,tdClass:"p-1",thClass:"p-1"}],tipos_documentos:[{value:33,text:"FACTURA"},{value:39,text:"BOLETA"},{value:52,text:"GUIA DESPACHO"}],modal_certificado:!1,modal_pdf:!1,articulo_seleccionado:"",archivo_certificado:"",pdf_certificado:"",modal_verificar_huella:!1}},mounted(){this.listarEstantes()},methods:{listarEstantes(){this.cargando_pagina=!0,axios.post(base_url+"bodega/listarEstantes").then(a=>{this.estantes=a.data.estantes,this.cargando_pagina=!1,console.log(this.estantes)}).catch(a=>{console.log(a),this.cargando_pagina=!1})},listarArticulosEspacio(a){this.cargando_articulos_espacio=!0;const t=new URLSearchParams;t.append("id_espacio",a),axios.post(base_url+"bodega/listarArticulosEspacio",t).then(a=>{this.articulos_espacio=a.data,this.cargando_articulos_espacio=!1}).catch(a=>{console.log(a),this.cargando_articulos_espacio=!1})},listarHistorialEspacio(a){this.cargando_historial_espacio=!0;const t=new URLSearchParams;t.append("id_espacio",a),axios.post(base_url+"bodega/listarHistorialEspacio",t).then(a=>{this.historial_espacio=a.data,this.cargando_historial_espacio=!1}).catch(a=>{console.log(a),this.cargando_historial_espacio=!1})},muetraModalCertificado(a){this.articulo_seleccionado=a,this.modal_certificado=!0},async certificarArticulo(){this.cargando_pagina=!0;const a=this.archivo_certificado[0];if(a){let t=await this.getFileBase64(a);t="data:application/pdf;base64,"+t;const e=new URLSearchParams;e.append("id_articulo",this.articulo_seleccionado.ari_id),e.append("archivo",t),axios.post(base_url+"bodega/certificarArticulo",e).then(a=>{this.cargando_pagina=!1,this.modal_certificado=!1,this.archivo_certificado="",this.listarArticulosEspacio(this.espacio_seleccionado.esp_id)}).catch(a=>{console.log(a),this.cargando_pagina=!1})}else alert("Debe seleccionar un archivo")},verificacionCorrrecta(a){this.modal_verificar_huella=!1,this.certificarArticulo()},getFileBase64(a){return new Promise((t,e)=>{const s=new FileReader;s.readAsDataURL(a),s.onload=()=>t(s.result.split(",")[1]),s.onerror=a=>e(a)})}}},r=o,l=(e("2f12"),e("2877")),n=Object(l["a"])(r,s,i,!1,null,"ec689ace",null);t["default"]=n.exports},c215:function(a,t,e){"use strict";e("df28")},c59e:function(a,t){!function(a){"use strict";a('.navbar-sidenav [data-toggle="tooltip"]').tooltip({template:'<div class="tooltip navbar-sidenav-tooltip" role="tooltip" style="pointer-events: none;"><div class="arrow"></div><div class="tooltip-inner"></div></div>'}),a("#sidenavToggler").click((function(t){t.preventDefault(),a("body").toggleClass("sidenav-toggled"),a(".navbar-sidenav .nav-link-collapse").addClass("collapsed"),a(".navbar-sidenav .sidenav-second-level, .navbar-sidenav .sidenav-third-level").removeClass("show")})),a(".navbar-sidenav .nav-link-collapse").click((function(t){t.preventDefault(),a("body").removeClass("sidenav-toggled")})),a("body.fixed-nav .navbar-sidenav, body.fixed-nav .sidenav-toggler, body.fixed-nav .navbar-collapse").on("mousewheel DOMMouseScroll",(function(a){var t=a.originalEvent,e=t.wheelDelta||-t.detail;this.scrollTop+=30*(e<0?1:-1),a.preventDefault()})),a(document).scroll((function(){a(this).scrollTop()>100?a(".scroll-to-top").fadeIn():a(".scroll-to-top").fadeOut()})),a('[data-toggle="tooltip"]').tooltip(),a(document).on("click","a.scroll-to-top",(function(t){var e=a(this);a("html, body").stop().animate({scrollTop:a(e.attr("href")).offset().top},1e3,"easeInOutExpo"),t.preventDefault()}))}(jQuery)},cdf6:function(a,t,e){"use strict";e("ed81")},de34:function(a,t,e){a.exports=e.p+"img/huella2.99153964.png"},df28:function(a,t,e){},e072:function(a,t,e){},ed81:function(a,t,e){},fbac:function(a,t,e){a.exports=e.p+"img/huella3.3eb5fd80.png"}});
//# sourceMappingURL=app.65e62bbe.js.map