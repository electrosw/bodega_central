{"remainingRequest":"/srv/repos/bodega_central/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/srv/repos/bodega_central/frontend/src/components/bodega/Ingreso_nuevo.vue?vue&type=style&index=0&id=0b0326a9&prod&scoped=true&lang=css&","dependencies":[{"path":"/srv/repos/bodega_central/frontend/src/components/bodega/Ingreso_nuevo.vue","mtime":1718746405426},{"path":"/srv/repos/bodega_central/frontend/node_modules/css-loader/dist/cjs.js","mtime":1676473588380},{"path":"/srv/repos/bodega_central/frontend/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1676473588036},{"path":"/srv/repos/bodega_central/frontend/node_modules/postcss-loader/src/index.js","mtime":1676473588672},{"path":"/srv/repos/bodega_central/frontend/node_modules/cache-loader/dist/cjs.js","mtime":1676473588660},{"path":"/srv/repos/bodega_central/frontend/node_modules/vue-loader/lib/index.js","mtime":1676473588036}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5lc3BhY2lvIHsKICBjdXJzb3I6IHBvaW50ZXI7Cn0KCi5lc3BhY2lvOmhvdmVyIHsKICBjb2xvcjogIzE1NTcyNDsKICBiYWNrZ3JvdW5kLWNvbG9yOiAjZDRlZGRhOwogIGJvcmRlci1jb2xvcjogI2MzZTZjYjsKfQoKLmVzcGFjaW86YWN0aXZlewogIGJhY2tncm91bmQtY29sb3I6ICMyMGM5OTc7Cn0KCi50YWJsZS1zY3JvbGwgewogIHBvc2l0aW9uOiByZWxhdGl2ZTsKICBoZWlnaHQ6IDQwMHB4OwogIG92ZXJmbG93OiBhdXRvOwp9CgouZGl2LXNjcm9sbCB7CiAgcG9zaXRpb246IHJlbGF0aXZlOwogIG92ZXJmbG93OiBhdXRvOwogIG1heC1oZWlnaHQ6IDQwMHB4Owp9Cg=="},{"version":3,"sources":["Ingreso_nuevo.vue"],"names":[],"mappings":";AAuRA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"Ingreso_nuevo.vue","sourceRoot":"src/components/bodega","sourcesContent":["<template>\n  <div class=\"container-fluid\">\n    <loader-component :cargando_pagina=\"cargando_pagina\"/>\n    <div class=\"row\">\n      <div class=\"col-12 text-md-left text-center\">\n        <h3><i class=\"fas fa-fw fa-box mr-2\"></i>INGRESO BODEGA</h3>\n      </div>\n    </div>\n\n\n    <div class=\"row justify-content-center mt-4\">\n      <div class=\"col-xl-6 col-md-10 col-12\">\n       <!--  DOCUMENTO\n        <b-form-input v-model=\"nuevo_ingreso.documento\" class=\"mb-3\"></b-form-input>\n        TIPO DOCUMENTO\n        <b-form-select v-model=\"nuevo_ingreso.tipo_documento\" class=\"mb-3\" :options=\"tipos_documentos\"></b-form-select> -->\n        ORDEN DE COMPRA\n        <b-form-input v-model=\"nuevo_ingreso.orden_compra\" class=\"mb-3\"></b-form-input>\n        <!-- SUCURSAL DESTINO\n        <b-form-select v-model=\"nuevo_ingreso.sucursal\" class=\"mb-3\" :options=\"sucursales\" :value-field=\"'suc_id'\" :text-field=\"'suc_nombre'\"></b-form-select>\n        FECHA ESTIMADA DESPACHO\n        <b-form-datepicker v-model=\"nuevo_ingreso.fecha_despacho\" class=\"mb-3\" :min=\"fecha_actual\" placeholder=\"SELECCIONA FECHA\" label-help=\"Selecciona un día.\" label-no-date-selected=\"-\" label-next-month=\"SIGUIENTE MES\" label-prev-month=\"MES ANTERIOR\" label-prev-year=\"AÑO ANTERIOR\" label-next-year=\"SIGUIENTE AÑO\" label-current-month=\"MES ACTUAL\" start-weekday=\"1\"></b-form-datepicker>\n        ESPACIOS A UTILIZAR\n        <b-form-input type=\"number\" class=\"mb-3\"></b-form-input> -->\n      </div>\n      <div class=\"col-12 text-center\">\n        <b-button :disabled=\"nuevo_ingreso.orden_compra == ''\" @click=\"listarOrdenCompra();\" variant=\"primary\" size=\"sm\">ACEPTAR</b-button>\n      </div>\n    </div>\n\n    <div class=\"row justify-content-center mt-4\">\n      <div class=\"col-xl-10 col-md-12 col-12\">\n        ARTICULOS ORDEN DE COMPRA\n        <b-table striped hover :items=\"articulos_oc\" :fields=\"columnas_articulos\" :thead-tr-class=\"'text-center align-middle bg-dark text-white'\">\n          <template v-slot:cell(cantidad_r)=\"data\">\n            <b-form-input type=\"number\" v-model=\"data.item.value\"></b-form-input>\n          </template>\n        </b-table>\n      </div>\n    </div>\n\n    <b-modal v-model=\"modal_seleccionar\" size=\"lg\" title=\"SELECCIONA LUGAR\" hide-footer no-close-on-backdrop :scrollable=\"false\">\n      <div class=\"row\">\n        <div class=\"col\">\n          <h6>BUSCAR ESTANTE</h6>\n          <b-form-input placeholder=\"Numero de estante\" @input=\"filtrarEstantes();\" v-model=\"filtro_estante\" class=\"mb-3\"></b-form-input>\n        </div>\n      </div>\n      <div class=\"row mt-2 div-scroll\">\n        <!-- <div class=\"col-4 text-center\" v-for=\"(espacio, index) in esp_disp_filtrados\" :key=\"'esp'+index\">\n          <b-card no-body class=\"p-1 espacio\">\n            <h6> Estante: <strong>{{ espacio.esp_estante }}</strong> Sección: <strong>{{ espacio.esp_seccion }}</strong></h6>\n            <h6> Espacio: <strong>{{ espacio.esp_numero }}</strong></h6>\n            <h6> Peso: <strong>{{ espacio.esp_peso }}</strong></h6>\n          </b-card>\n        </div> -->\n        <table class=\"table table-striped text-center table-scroll\">\n          <thead>\n            <tr>\n              <th scope=\"col\">ESTANTE</th>\n              <th scope=\"col\">SECCION</th>\n              <th scope=\"col\">ESPACIO</th>\n              <th scope=\"col\">PESO</th>\n              <th scope=\"col\">-</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr v-for=\"(espacio, index) in esp_disp_filtrados\" :key=\"'esp'+index\">\n              <td class=\"p-1\">{{espacio.esp_estante}}</td>\n              <td class=\"p-1\">{{espacio.esp_seccion}}</td>\n              <td class=\"p-1\">{{espacio.esp_numero}}</td>\n              <td class=\"p-1\">{{espacio.esp_peso}}</td>\n              <td class=\"p-1\"><b-button @click=\"nuevo_ingreso.espacio = espacio; modal_confirmar=true;\" variant=\"info\" size=\"sm\"><i class=\"fas fa-check\"></i></b-button></td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n      <div class=\"row mt-3 pt-3 border-top\">\n        <div class=\"col text-center\">\n          <b-button @click=\"modal_seleccionar=false;\" variant=\"danger\" size=\"sm\">CERRAR</b-button>\n        </div>\n      </div>\n    </b-modal>\n\n    <b-modal v-model=\"modal_confirmar\" size=\"lg\" title=\"CONFIRMAR REGISTRO\" hide-footer no-close-on-backdrop :scrollable=\"false\">\n      <div class=\"row\">\n        <div class=\"col-12\">\n          <h6><strong>DATOS DE INGRESO</strong></h6>\n        </div>\n        <div class=\"col-5\"><h6>TIPO DOCUMENTO</h6></div>\n        <div class=\"col-7\"><h6 v-for=\"(doc,index) in tipos_documentos\" :key=\"'tip'+index\" v-show=\"doc.value==nuevo_ingreso.tipo_documento\">: {{doc.text}}</h6></div>\n        <div class=\"col-5\"><h6>N° DOCUMENTO</h6></div>\n        <div class=\"col-7\"><h6>: {{nuevo_ingreso.documento}}</h6></div>\n        <div v-if=\"nuevo_ingreso.orden_compra != ''\" class=\"col-5\"><h6>ORDEN COMPRA</h6></div>\n        <div v-if=\"nuevo_ingreso.orden_compra != ''\" class=\"col-7\"><h6>: {{nuevo_ingreso.orden_compra}}</h6></div>\n        <div class=\"col-5\"><h6>FECHA ESTIMADA DESPACHO</h6></div>\n        <div class=\"col-7\"><h6>: {{nuevo_ingreso.fecha_despacho.split('-')[2]+'-'+nuevo_ingreso.fecha_despacho.split('-')[1]+'-'+nuevo_ingreso.fecha_despacho.split('-')[0]}}</h6></div>\n        <div class=\"col-5\"><h6>PESO</h6></div>\n        <div class=\"col-7\"><h6>: {{nuevo_ingreso.peso}}</h6></div>\n\n        <div class=\"col-12 mt-3\">\n          <h6><strong>LUGAR PARA ALMACENAR</strong></h6>\n        </div>\n        <div class=\"col-5\"><h6>ESTANTE</h6></div>\n        <div class=\"col-7\"><h6>: {{nuevo_ingreso.espacio.esp_estante}}</h6></div>\n        <div class=\"col-5\"><h6>SECCION</h6></div>\n        <div class=\"col-7\"><h6>: {{nuevo_ingreso.espacio.esp_seccion}}</h6></div>\n        <div class=\"col-5\"><h6>ESPACIO</h6></div>\n        <div class=\"col-7\"><h6>: {{nuevo_ingreso.espacio.esp_numero}}</h6></div>\n        <div class=\"col-5\"><h6>CAPACIDAD (Kg)</h6></div>\n        <div class=\"col-7\"><h6>: {{nuevo_ingreso.espacio.esp_peso}}</h6></div>\n      </div>\n      <div class=\"row mt-3 pt-3 border-top\">\n        <div class=\"col text-center\">\n          <b-button @click=\"registrarIngreso()\" variant=\"primary\" size=\"sm\">CONFIRMAR</b-button>\n        </div>\n      </div>\n    </b-modal>\n\n    <b-modal v-model=\"modal_msj\" size=\"lg\" title=\"REGISTRO DE INGRESO\" hide-footer no-close-on-backdrop :scrollable=\"false\">\n      <div class=\"row\">\n        <div class=\"col-12\">\n          <h6><strong>{{msj_registro}}</strong></h6>\n        </div>\n      </div>\n      <div class=\"row mt-3 pt-3 border-top\">\n        <div class=\"col text-center\">\n          <b-button @click=\"limpiarDatos();\" variant=\"primary\" size=\"sm\">ACEPTAR</b-button>\n        </div>\n      </div>\n    </b-modal>\n\n  </div>\n</template>\n\n<script>\nexport default {\n  data(){\n    return{\n      cargando_pagina   : false,\n      nuevo_ingreso     : {documento:'', tipo_documento:'', orden_compra:'', sucursal:'', fecha_despacho:'', peso:'', espacio:''},\n      sucursales        : [],\n      tipos_documentos  : [\n        {value:33, text:'FACTURA'}, \n        {value:39, text:'BOLETA'}, \n        {value:52, text:'GUIA DESPACHO'}\n      ],\n      espacios_disponibles  : [],\n      esp_disp_filtrados    : [],\n      modal_seleccionar     : false,\n      modal_confirmar       : false,\n      modal_msj             : false,\n      msj_registro          : '',\n      filtro_estante        : '',\n      fecha_actual          : '',\n\n      columnas_articulos    : [\n        {key: 'numero'      , label: 'SKU'                , sortable: true},\n        {key: 'nombre'      , label: 'Articulo'           , sortable: true},\n        {key: 'cantidad_c'  , label: 'Cantidad comprada'  , sortable: true},\n        {key: 'cantidad_r'  , label: 'Cantidad recibida'  , sortable: true},\n        {key: 'opcion'      , label: 'Opciones'           , sortable: false}\n      ],\n\n      articulos_oc          : [\n        {numero: 123, nombre:'PLANCHA OSB 9MM'        , cantidad_c:100, cantidad_r:0},\n        {numero: 321, nombre:'PLANCHA ZINC 4MTS'      , cantidad_c:200, cantidad_r:0},\n        {numero: 345, nombre:'PLANCHA TERCIADO 18MM'  , cantidad_c:150, cantidad_r:0},\n        {numero: 534, nombre:'PLANCHA OSB 12MM'       , cantidad_c:120, cantidad_r:0},\n        {numero: 678, nombre:'CLAVOS 4\"'              , cantidad_c:100, cantidad_r:0},\n        {numero: 456, nombre:'CEMENTO POLPAICO'       , cantidad_c:50 , cantidad_r:0},\n      ]\n    }\n  },\n  mounted(){\n    this.fecha_actual = new Date();\n    this.listarSucursales();\n  },\n  methods:{\n    listarOrdenCompra(){\n      this.cargando_pagina = true;\n      const datos = new URLSearchParams();\n      datos.append('orden_compra', this.nuevo_ingreso.orden_compra);\n      axios.post(base_url+'bodega/listarOrdenCompra', datos).then( resp => {\n        console.log(resp.data);\n        this.cargando_pagina      = false;\n      }).catch(error =>{\n        console.log(error);\n        this.cargando_pagina = false;\n      });\n    },\n\n\n\n\n\n    listarEspaciosDisponibles(){\n      this.cargando_pagina = true;\n      const datos = new URLSearchParams();\n      datos.append('peso', this.nuevo_ingreso.peso);\n      axios.post(base_url+'bodega/listarEspaciosDisponibles', datos).then( resp => {\n        this.espacios_disponibles = resp.data;\n        this.filtrarEstantes();\n        this.modal_seleccionar    = true;\n        this.cargando_pagina      = false;\n      }).catch(error =>{\n        console.log(error);\n        this.cargando_pagina = false;\n      });\n    },\n\n    filtrarEstantes(){\n      if(this.filtro_estante != ''){\n        this.esp_disp_filtrados = [];\n        this.espacios_disponibles.forEach(espacio => {\n          if(espacio.esp_estante == this.filtro_estante){\n            this.esp_disp_filtrados.push(espacio);\n          }\n        });\n      }\n      else {\n        this.esp_disp_filtrados = JSON.parse(JSON.stringify(this.espacios_disponibles))\n      }\n    },\n\n    listarSucursales(){\n      this.cargando_pagina = true;\n      axios.post(base_url+'bodega/listarSucursales').then( resp => {\n        this.sucursales       = resp.data;\n        this.cargando_pagina  = false;\n      }).catch(error =>{\n        console.log(error);\n        this.cargando_pagina = false;\n      });\n    },\n\n    validaDatos(){\n      if(this.nuevo_ingreso.documento != '' && this.nuevo_ingreso.tipo_documento != '' && this.nuevo_ingreso.sucursal != '' && this.nuevo_ingreso.fecha_despacho != '' && this.nuevo_ingreso.peso != ''){\n        return true;\n      }\n      else {\n        return false;\n      }\n    },\n\n    registrarIngreso(){\n      this.cargando_pagina = true;\n      const datos = new URLSearchParams();\n      datos.append('ingreso', JSON.stringify(this.nuevo_ingreso));\n      axios.post(base_url+'bodega/registrarIngreso', datos).then( resp => {\n        if(resp.data.key == 1){\n          this.msj_registro      = 'INGRESO REGISTRADO CORRECTAMENTE.'\n          this.modal_msj         = true;\n          this.modal_seleccionar = false;\n          this.modal_confirmar   = false;\n          this.cargando_pagina   = false;\n        }\n        else {\n          this.msj_registro      = resp.data.msj;\n          this.modal_msj         = true;\n        }\n      }).catch(error =>{\n        console.log(error);\n        this.cargando_pagina = false;\n      });\n    },\n\n    limpiarDatos(){\n      this.nuevo_ingreso = {documento:'', tipo_documento:'', orden_compra:'', sucursal:'', fecha_despacho:'', peso:'', espacio:''};\n      this.espacios_disponibles = [];\n      this.modal_msj = false;\n    }\n    \n  }\n}\n\n</script>\n\n<style scoped>\n.espacio {\n  cursor: pointer;\n}\n\n.espacio:hover {\n  color: #155724;\n  background-color: #d4edda;\n  border-color: #c3e6cb;\n}\n\n.espacio:active{\n  background-color: #20c997;\n}\n\n.table-scroll {\n  position: relative;\n  height: 400px;\n  overflow: auto;\n}\n\n.div-scroll {\n  position: relative;\n  overflow: auto;\n  max-height: 400px;\n}\n</style>\n"]}]}